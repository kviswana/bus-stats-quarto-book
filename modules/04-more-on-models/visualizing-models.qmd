# Visualizing models {#sec-visualizing-models}

In this chapter, we will first revisit how to build visualize the two *mean* models we saw earlier in @sec-mean-model and @sec-category-means. To be sure, we already covered these in @sec-visualizing-mean-models, but repeat it with different examples to provide reinforcement.

We will then learn how to visualize line models that we learned about in @sec-best-fit-line. This will set the stage for us to learn how to *build* these models and construct the models as equations.

## Recap of models

From prior chapters, we have learned that a model takes as input the values of the explanatory variable(s) (if any) and outputs an estimated value of the outcome variable. 

We started off in @sec-mean-model by showing that, in the absence of an explanatory variable, the *mean* is the best model. For example, our *mpg* data frame contains data about several cars. Let us suppose that our outcome variable is *hwy*, the highway mileage of a car. 

If we are given only the data from that single column *hwy*, and nothing else, the best *model* we can come up with for *estimating* the highway mileage of a car is to always provide the average highway mileage from the data set.

We then considered, in @sec-category-means, the case where we had a single explanatory variable, a categorical one and saw that here too the same idea applies, except that the best model for a category is the average for that category.

We then studied, in @sec-best-fit-line the case of a single explanatory variable again, but this time the explanatory variable was numerical. We learned there about the *least squares criterion* to find the best model.

@sec-visualizing-mean-models showed us how to visualize the models we built around the idea of the *mean* as a model in @sec-mean-model and @#sec-category-means. In this chapter, we use new examples to briefly review how to visualize those models and also compute and write out the model functions. We then move on to visualizing our line models from @sec-best-fit-line and how to build and reconstruct the model function as an equation.

We will first learn how to visualize the models. We then look at how to generate the model function in equation form.


## Visualizing simple mean models (no explanatory variable)

We take a different dataset this time. The data frame *txhousing* contains real estate data for the state of Texas for several years. We first follow the good practice of understanding the dataset before jumping in and building models. @tbl-txhousing-head-10 shows the first 10 rows .

```{r eval=FALSE}
txhousing |>
    head(10) 
```

|city    | year| month| sales|   volume| median| listings| inventory| date|
|:-------|----:|-----:|-----:|--------:|------:|--------:|---------:|----:|
|Abilene | 2000|     1|    72|  5380000|  71400|      701|       6.3| 2000|
|Abilene | 2000|     2|    98|  6505000|  58700|      746|       6.6| 2000|
|Abilene | 2000|     3|   130|  9285000|  58100|      784|       6.8| 2000|
|Abilene | 2000|     4|    98|  9730000|  68600|      785|       6.9| 2000|
|Abilene | 2000|     5|   141| 10590000|  67300|      794|       6.8| 2000|
|Abilene | 2000|     6|   156| 13910000|  66900|      780|       6.6| 2000|
|Abilene | 2000|     7|   152| 12635000|  73500|      742|       6.2| 2000|
|Abilene | 2000|     8|   131| 10710000|  75000|      765|       6.4| 2001|
|Abilene | 2000|     9|   104|  7615000|  64500|      771|       6.5| 2001|
|Abilene | 2000|    10|   101|  7040000|  59300|      764|       6.6| 2001|

: First 10 rows from the *txhousing* data frame {#tbl-txhousing-head-10}

We see that for the first 10 rows,  *city* and *year* are the same, but there is variation in the other variables. The dataset has 8602 observations or rows. Use the command ?txhousing in RStudio to answer the following questions. 

::: {.callout-note icon=false}
## Quick Check {.unnumbered}

What is the *unit of observation* int his dataset? Unfortunately, the codebook does not give sufficient details. Se if you can use ChatGPT or other chatbot to find the answer.
:::

::: {.callout-note icon=false collapse=true}
## Suggested answer {.unnumbered}

For every city in Texas, the dataset has its real estate activity for one month. The data spans 12 months each from 2000 to 2014 and for 2015 7 months from Jan to July. There are 46 cities. For each city we have data for 180 + 7 = 187 months. Therefore the unit of observation is the real estate activity for a single city for a single month.
:::

::: {.callout-note icon=false}
## Quick Check {.unnumbered}

Explain precisely what the first row tells us.
:::

::: {.callout-note icon=false collapse=true}
## Suggested answer {.unnumbered}

The first row tells us that in Jan 2000, the city of Abilene had 72 sales, 701 listings, and so on.
:::

::: {.callout-note icon=false}
## Quick Check {.unnumbered}

Why does the data frame have 8602 rows?
:::

::: {.callout-note icon=false collapse=true}
## Suggested answer {.unnumbered}

187 months times 46 cities = 8602.
:::

If you had access to only the column *listings* and we had to build a model to predict *listings* based on no other information, what would you predict?


```{r}
#| eval: false
txhousing|>
    point_plot(listings ~ 1, annot = "model", interval = "none")
```

In this example, our outcome variable is *listings* and we have no explanatory variable. Therefore we use "1" on the RHS of the tilde expression. 

This code shows you how to add a model as an annotation. We had used "annot=" earlier for generating violin plots. Here we use:

annot = "model", interval = "none"

The first part asks the function to annotate the scatter plot with a model. 
For now, we will just use the second part "interval = ..." without explanation. Later in the course, you will see why we use this.

![Scatter plot of *listings* from the *txhousing* data frame annotated with a model: the model is the blue horizontal line at the average value of listings (3217)](../../images/fig-txhousing-listings-mean-model.png){#fig-txhousing-listings-mean-model width=70% fig-align=center}

Let us see one more example of visualizing a simple mean model.

The data frame *Boston_marathon* contains data about the results of the Boston Marathon over the years.

Like we did with the *txhousing* data frame, we should first understand the data frame before processing it. Take a look at the codebook for the *Boston_marathon* data frame and answer the following questions. Try to recall how we got the codebook for *txhousing* and use the same approach here. The codebook is not too informative, but just viewing it using View(Boston_marathon) might tell you what you need to know.

::: {.callout-note icon=false}
## Quick Check {.unnumbered}

How many variables does the data frame have?
:::

::: {.callout-note icon=false collapse=true}
## Suggested answer {.unnumbered}

Six
:::

::: {.callout-note icon=false}
## Quick Check {.unnumbered}

What is the unit of observation? That is, what does a row tell us about?
:::

::: {.callout-note icon=false collapse=true}
## Suggested answer {.unnumbered}

Each row tells us about the result of a year's race for a gender. The unit of observation therefore is the result of a race in a year -- with the races for males and females being considered as different races. 

We have two rows for years starting from 1972 when women started participating. Prior to that, from 1897 to 1971, we have only one row per year.
:::

::: {.callout-note icon=false}
## Quick Check {.unnumbered}

Which column shows the finishing time?
:::

::: {.callout-note icon=false collapse=true}
## Suggested answer {.unnumbered}

The variable *time* shows the finishing time in seconds and the colvariableumn *minutes* shows it in minutes. 
:::

::: {.callout-note icon=false}
## Quick Check {.unnumbered}

How can you verify the suggested answer from the previous question?
:::

::: {.callout-note icon=false collapse=true}
## Suggested answer {.unnumbered}

Multiply *minutes* by 60 and that should equal *time*. However, we cannot use the variable *time* as it is not numerical. (Take a close look.)
:::

Let us visualize a model for the variable *minutes*. As before, we generate the scatter plot and then annotate with a model. We changed the data frame and the tilde expression. @fig-boston-marathon-minutes-model shows the plot. The model line is at *minutes = 144*.

```{r}
#| eval: false
Boston_marathon |> 
  point_plot(minutes ~ 1, annot = "model",
             interval = "none")
```

![Scatter plot of *minutes* from the *Boston_marathon* data frame annotated with a model](../../images/fig-boston-marathon-minutes-model.png){#fig-boston-marathon-minutes-model width=70% fig-align=center}

## Visualizing category mean models (single explanatory variable that is categorical)

We built a model for *minutes* from the *Boston_marathon* data frame assuming no explanatory variable. What if we used *sex* as the explanatory variable? @fig-boston-marathon-minutes-sex-model shows the model. This time we have a separate mean model for each sex.

```{r}
#| eval: false
Boston_marathon |> 
  point_plot(minutes ~ sex, annot = "model",
             interval = "none")
```

![Boston marathon model for *minutes* with *sex8 as the explanatory variabl](../../images/fig-boston-marathon-minutes-sex-model.png){#fig-boston-marathon-minutes-sex-model width=70% fig-align=center}

For another example, we now use the *mpg* data frame and plot a model for the city. mileage (variable *cty*) with the kind of drive (variable *drv*) as the explanatory variable. @fig-mpg-cty-drv-model shows the plot. This time we see that the model is the mean for each kind of drive.

```{r}
#| eval: false
mpg |> 
  point_plot(cty ~ drv, annot = "model", 
             interval = "none")
```


![Model of category means for *cty ~ drv* for the *mpg* data frame](../../images/fig-mpg-cty-drv-model.png){#fig-mpg-cty-drv-model width=70% fig-align=center}

## Visualizing least-squares line models (single explanatory variable that is numeric)

We use the *Anthro_F* data frame. Take a look at its codebook and answer the following question.

::: {.callout-note icon=false}
## Quick Check {.unnumbered}

What is the unit of observation?
:::

::: {.callout-note icon=false collapse=true}
## Suggested answer {.unnumbered}

Each row gives us information about a single college woman in the age range 18-25. SO the unit of observation is a *single college woman in the age range 18-25*.
:::

We would like to visualize a model that predicts the body fat (variable *BFat*) with *Wrist* as the explanatory variable. @fig-anthro-f-wrist-bfat-model shows the scatter plot and the least squares line.

```{r}
#| eval: false
 Anthro_F |> 
  point_plot(BFat ~ Wrist, annot = "model",
             interval = "none")
```

![Least squares line model for the *Anthro_f* data frame: *BFat* as the response variable with *Wrist* as the explanatory variable](../../images/fig-anthro-f-wrist-bfat-model.png){#fig-anthro-f-wrist-bfat-model width=70% fig-align=center}






