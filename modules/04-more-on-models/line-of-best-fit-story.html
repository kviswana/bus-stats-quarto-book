<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>9&nbsp; Line of Best Fit – Introduction to Business Statistics: A Modeling Approach</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../modules/04-more-on-models/visualizing-models.html" rel="next">
<link href="../../modules/04-more-on-models/04-overview.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-985aa47af68dae11cd4d235c71fb941e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-6598efebc0fc82f63c3510b9ac47738c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../modules/04-more-on-models/04-overview.html">More on models – least squares</a></li><li class="breadcrumb-item"><a href="../../modules/04-more-on-models/line-of-best-fit-story.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Line of Best Fit</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../images/logo-dark.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Introduction to Business Statistics: A Modeling Approach</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Business Statistics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Data, Visualization, and Patterns</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../modules/01-data-visualization/01-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 1: Data, Visualization &amp; Patterns</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../modules/01-data-visualization/data-frames.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Data Frames and Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../modules/01-data-visualization/point-plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Exploring Relationships through Scatterplots</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Variation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../modules/02-variability/02-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 2: Variation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../modules/02-variability/violin-plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Using Violin Plots to Visualize Distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../modules/02-variability/variance-and-sd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Variance and standard deviation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Introduction to models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../modules/03-introduction-to-models/03-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 3: Introduction to models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../modules/03-introduction-to-models/path-to-models-story.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">The Simplest Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../modules/03-introduction-to-models/category-means-story.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Category Means</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../modules/03-introduction-to-models/intro-to-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">What is a model?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../modules/03-introduction-to-models/visualizing-simple-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Visualizing Mean Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">More on models – least squares</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../modules/04-more-on-models/04-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 4: Linear Regression Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../modules/04-more-on-models/line-of-best-fit-story.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Line of Best Fit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../modules/04-more-on-models/visualizing-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Visualizing Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../modules/04-more-on-models/finding-the-model-function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Finding the Model Function</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../modules/04-more-on-models/model-with-cat-and-num-explanatories-story.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Amanda’s New Challenge</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Explanatory Power of a Model</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../modules/05-explanatory-power-of-models/05-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 5: Explanatory Power of a Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../modules/05-explanatory-power-of-models/explain-as-used-in-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title"><em>Explain</em> as used in Statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../modules/05-explanatory-power-of-models/variance-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Explaining Variation in Outcome Variable with Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../modules/05-explanatory-power-of-models/accounting-for-variance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">The Variance Equation and <span class="math inline">\(R^2\)</span></span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-beach-kiosk-staffing-problem" id="toc-the-beach-kiosk-staffing-problem" class="nav-link active" data-scroll-target="#the-beach-kiosk-staffing-problem"><span class="header-section-number">9.1</span> The beach kiosk staffing problem</a>
  <ul class="collapse">
  <li><a href="#how-does-this-differ-from-earlier-examples-we-have-studied" id="toc-how-does-this-differ-from-earlier-examples-we-have-studied" class="nav-link" data-scroll-target="#how-does-this-differ-from-earlier-examples-we-have-studied"><span class="header-section-number">9.1.1</span> How does this differ from earlier examples we have studied?</a></li>
  <li><a href="#toward-a-rule-based-model" id="toc-toward-a-rule-based-model" class="nav-link" data-scroll-target="#toward-a-rule-based-model"><span class="header-section-number">9.1.2</span> Toward a rule-based model</a></li>
  </ul></li>
  <li><a href="#visualizing-the-model" id="toc-visualizing-the-model" class="nav-link" data-scroll-target="#visualizing-the-model"><span class="header-section-number">9.2</span> Visualizing the model</a></li>
  <li><a href="#what-do-we-mean-by-the-best-model" id="toc-what-do-we-mean-by-the-best-model" class="nav-link" data-scroll-target="#what-do-we-mean-by-the-best-model"><span class="header-section-number">9.3</span> What do we mean by the <em>best</em> model?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../modules/04-more-on-models/04-overview.html">More on models – least squares</a></li><li class="breadcrumb-item"><a href="../../modules/04-more-on-models/line-of-best-fit-story.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Line of Best Fit</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-best-fit-line" class="quarto-section-identifier"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Line of Best Fit</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In prior chapters we have looked at the situation when we have a numerical response variable and either no explanatory variable or a single categorical explanatory variable. In this chapter we look at the important case when the response variable and the explanatory variable are numerical.</p>
<p>In our running story, this is the third meeting of our interns with Amanda who owns a business that operates kiosks in a city at two locations. Last month, the interns used kiosk labels to help set different staffing levels for the Beach and the Mall.</p>
<p>Now Amanda brings a new kind of hint.</p>
<p>“It’s not just location that seems to affect the number of customers we get.” she says. “Today, I need you all to help me with a decision for the beach kiosk. At the Beach kiosk, demand seems to swing with temperature. I want a model that uses what we know <em>today</em> about tomorrow’s temperature (the forecast) to predict customer traffic for tomorrow. This time, I will use the prediction not for staffing, but to decide on stock levels of items. We do not want to under or overstock too much and so good predictions can really help me.”</p>
<p>She adds one constraint immediately:</p>
<p>“Keep it simple. I need something I can explain in one sentence.”</p>
<p>In this chapter, we continue our model-building journey. A model is simply a rule that takes information we have and produces a predicted value for the response.</p>
<ul>
<li><p>With no explanatory variable, we learned in <a href="../03-introduction-to-models/path-to-models-story.html" class="quarto-xref"><span>Chapter 5</span></a>, that our model is “always predict the mean.”</p></li>
<li><p>With a single categorical explanatory variable, <a href="../03-introduction-to-models/category-means-story.html" class="quarto-xref"><span>Chapter 6</span></a> showed us that our model should be “predict the mean of the category.”</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Quick Check">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Quick Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>When we use the mean as a model, what value do we predict for every observation?</p>
<p>Why is this considered a model rather than just a summary?</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The model predicts the same value—the mean—for every observation.</p>
<p>It is a model because it provides a rule for generating predicted values, not just a numerical description of the data.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Quick Check">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Quick Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>How does a category-mean model improve on the overall mean model?</p>
<p>What additional information does it use?</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A category-mean model allows different predictions for different groups.</p>
<p>It improves on the overall mean model by using information about group membership instead of treating all observations as identical.</p>
</div>
</div>
</div>
<p>In this chapter we consider a single numerical explanatory variable. In this case we need something quite different.</p>
<section id="the-beach-kiosk-staffing-problem" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="the-beach-kiosk-staffing-problem"><span class="header-section-number">9.1</span> The beach kiosk staffing problem</h2>
<p>We again consider a situation where the company gets a hint before making a decision—but now the hint is numerical, not categorical.</p>
<p>Amanda is focused on the Beach kiosk. (The Mall kiosk is steadier, but the Beach kiosk shas more variance in daily customer numbers and so just using the average can be costly.</p>
<p>Management has noticed that customer traffic at the Beach kiosk varies strongly with the day’s high temperature.</p>
<p>Over many past days, the company has recorded:</p>
<ul>
<li><p>the day’s high temperature (in °F), and</p></li>
<li><p>the number of customers who visited the beach kiosk that day.</p></li>
</ul>
<p>Let us assume that data are available for 25 different days. (As before, for understanding the ideas, the exact number of days is not important.)</p>
<p><a href="#tbl-temp-customers" class="quarto-xref">Table&nbsp;<span>9.1</span></a> shows the historical data.</p>
<div id="tbl-temp-customers" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-temp-customers-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.1: Daily temperature and customer counts
</figcaption>
<div aria-describedby="tbl-temp-customers-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">day</th>
<th style="text-align: right;">temperature</th>
<th style="text-align: right;">customers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">D01</td>
<td style="text-align: right;">58</td>
<td style="text-align: right;">98</td>
</tr>
<tr class="even">
<td style="text-align: left;">D02</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">104</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D03</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">122</td>
</tr>
<tr class="even">
<td style="text-align: left;">D04</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">113</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D05</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">117</td>
</tr>
<tr class="even">
<td style="text-align: left;">D06</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">133</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D07</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">126</td>
</tr>
<tr class="even">
<td style="text-align: left;">D08</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">115</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D09</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">123</td>
</tr>
<tr class="even">
<td style="text-align: left;">D10</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">128</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D11</td>
<td style="text-align: right;">78</td>
<td style="text-align: right;">145</td>
</tr>
<tr class="even">
<td style="text-align: left;">D12</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">141</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D13</td>
<td style="text-align: right;">58</td>
<td style="text-align: right;">106</td>
</tr>
<tr class="even">
<td style="text-align: left;">D14</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">107</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D15</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">105</td>
</tr>
<tr class="even">
<td style="text-align: left;">D16</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">127</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D17</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">120</td>
</tr>
<tr class="even">
<td style="text-align: left;">D18</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">103</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D19</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">128</td>
</tr>
<tr class="even">
<td style="text-align: left;">D20</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">121</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D21</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">120</td>
</tr>
<tr class="even">
<td style="text-align: left;">D22</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">130</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D23</td>
<td style="text-align: right;">78</td>
<td style="text-align: right;">127</td>
</tr>
<tr class="even">
<td style="text-align: left;">D24</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">132</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D25</td>
<td style="text-align: right;">58</td>
<td style="text-align: right;">98</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Based this, the company must decide how many customers will show up tomorrow. They will u8se that to determine how much of each item to stock for sale. It can use an extremely reliable temperature forecast for its city.</p>
<p>The problem now is this:</p>
<blockquote class="blockquote">
<p>Given the forecast high temperature for a day, how many customers should the company plan for?</p>
</blockquote>
<section id="how-does-this-differ-from-earlier-examples-we-have-studied" class="level3" data-number="9.1.1">
<h3 data-number="9.1.1" class="anchored" data-anchor-id="how-does-this-differ-from-earlier-examples-we-have-studied"><span class="header-section-number">9.1.1</span> How does this differ from earlier examples we have studied?</h3>
<p>In <a href="../03-introduction-to-models/path-to-models-story.html" class="quarto-xref"><span>Chapter 5</span></a>, we used no hints at all, and the mean turned out to be the best model.</p>
<p>In <a href="../03-introduction-to-models/category-means-story.html" class="quarto-xref"><span>Chapter 6</span></a>, our hint was categorical, and the mean within each category turned out to be the best model.</p>
<p>This time, the situation is fundamentally different. Our hint, temperature, is numerical, and so none of the earlier “mean-based” approaches applies directly.</p>
<p>One possibility would be to convert temperature into categories such as <em>Cold</em>, <em>Warm</em>, and <em>Hot</em>, and then apply the category-means approach. While this would work, it is somewhat artificial. Two days that differ by only one degree could end up in different categories. For example, calling 50°F Cold and 51°F Warm introduces an arbitrary cutoff that has no real business justification.</p>
<p>Temperature does not naturally fall into clear bins. Can we do better?</p>
</section>
<section id="toward-a-rule-based-model" class="level3" data-number="9.1.2">
<h3 data-number="9.1.2" class="anchored" data-anchor-id="toward-a-rule-based-model"><span class="header-section-number">9.1.2</span> Toward a rule-based model</h3>
<p>Rather than assigning a few separate numbers, Amanda now wants a rule that:</p>
<blockquote class="blockquote">
<p>takes the day’s temperature as input and produces an estimated number of customers as output.</p>
</blockquote>
<p>Many such rules are possible. The company wants a simple rule that takes a temperature as input and produces a predicted number of customers as output. Let us assume that the same general pattern will continue for temperatures. It is not going to be exactly the same, but the general range and the distribution will remain the same for the next month. Therefore, if we applied our model to the data set in <a href="#tbl-temp-customers" class="quarto-xref">Table&nbsp;<span>9.1</span></a>, its output should reasonably match the actual number of customers in the data set.</p>
<p><a href="#fig-beach-kiosk-model-box-diagram" class="quarto-xref">Figure&nbsp;<span>9.1</span></a> shows what Amanda is looking for at a high level.</p>
<div id="fig-beach-kiosk-model-box-diagram" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-beach-kiosk-model-box-diagram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../../images/fig-beach-kiosk-model-box-diagram.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-beach-kiosk-model-box-diagram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.1: Model that takes a temperature as input and produces a predicted number of customers for the beach kiosk – the model should be based on the data in <a href="#tbl-temp-customers" class="quarto-xref">Table&nbsp;<span>9.1</span></a>
</figcaption>
</figure>
</div>
<p>We know that with higher temperatures more people will hit the beach.</p>
<p>Peter has an idea. “Since Amanda is looking for a simple rule, should we consider consider a model which looks something like this?” He draws a picture. <a href="#fig-specific-beach-kiosk-model-box" class="quarto-xref">Figure&nbsp;<span>9.2</span></a>). “Of course, I just made up the numbers 15 and 2. With this model, if we input a temperature of 70, the model will predict 155 customers.”</p>
<div id="fig-specific-beach-kiosk-model-box" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-specific-beach-kiosk-model-box-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../../images/fig-specific-beach-kiosk-model-box.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-specific-beach-kiosk-model-box-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.2: Caption
</figcaption>
</figure>
</div>
<p>Peter further clarifies “I did not mean the specific numbers 15 and 2 literally in <a href="#fig-specific-beach-kiosk-model-box" class="quarto-xref">Figure&nbsp;<span>9.2</span></a>, I am really saying that we could look for a model that has the general form in this figure” and he quickly sketches <a href="#fig-beach-kiosk-temp-generic-model" class="quarto-xref">Figure&nbsp;<span>9.3</span></a></p>
<p>“We just need to find <em>good</em> values for <em>a</em> and <em>b</em>.</p>
<div id="fig-beach-kiosk-temp-generic-model" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-beach-kiosk-temp-generic-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../../images/fig-beach-kiosk-temp-generic-model.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-beach-kiosk-temp-generic-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.3: Peter’s second explanatory sketch showing that he wants a model of this general form, but wants to find good values for <em>a</em> and <em>b</em> so that the model generates good predictions
</figcaption>
</figure>
</div>
<p>Peter then writes <a href="#eq-kiosk-cust-temp-model" class="quarto-xref">Equation&nbsp;<span>9.1</span></a> to explain the same idea and adds “I placed a <em>hat</em> on top of <em>customers</em> because the equation only calculates an <em>estimate</em> and this could be different from an actual value.”</p>
<p><span id="eq-kiosk-cust-temp-model"><span class="math display">\[
\widehat{\text{customers}} = a +  b\times\text{temperature}
\tag{9.1}\]</span></span></p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Peter has proposed a specific form of model from an <strong>infinite</strong> number of possible models. For example, the model could have taken any of the following forms. Each of them allows us to plug in a temperature and get an estimate for the number of customers, provided we fix some actual values for <em>a</em>, <em>b</em>, <em>c</em>, <em>x</em>, <em>y</em> and <em>z</em>.</p>
<p><span id="eq-linear-model-form"><span class="math display">\[
\widehat{\text{customers}} = a +  b\times\text{temperature}^2
\tag{9.2}\]</span></span></p>
<p><span class="math display">\[
\widehat{\text{customers}} = a + b\times\text{temperature} + c\times\text{temperature}^2
\]</span></p>
<p><span class="math display">\[
\widehat{\text{customers}} =
\begin{cases}
a &amp; \text{if } \text{temperature} \leq x \\
b &amp; \text{if } x &lt; \text{temperature} \leq y \\
c &amp; \text{if } \text{temperature} &gt; y
\end{cases}
\]</span></p>
<p>… and a model does not even have to have a mathematical form like the ones above. **Any method that can take a <em>temperature</em> as input and produce an estimated number of customers can be a model.</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>In many business and social science situations, we prefer <em>linear</em> models like <a href="#eq-linear-model-form" class="quarto-xref">Equation&nbsp;<span>9.2</span></a>. In this course, we only study linear models.</p>
<p>Fields like <em>machine learning</em> consider many other types of models.</p>
</div>
</div>
<p>Angela says “That’s a great idea Peter! Amanda wanted something simple. Of course we gave her very simple models earlier too, but now we have to incorporate <em>temperature</em> and I cannot imagine something that is adjusts its predictions to the temperature and is simpler than what Peter has shown.”</p>
<p>“If we fix the values of <em>a</em> and <em>b</em>, eq-kiosk-cust-temp-model produces a predicted number of customers for any temperature. For example, if we fix a value of 15 for <em>a</em> and 2 for <em>b</em> as Peter did before, then <a href="#eq-kiosk-cust-temp-model-specific" class="quarto-xref">Equation&nbsp;<span>9.3</span></a> shows our model to determine the number of customers for any temperature. If we plug in a temperature of 70, the model will give us 155 as the estimated number of customers.”</p>
<p><span id="eq-kiosk-cust-temp-model-specific"><span class="math display">\[
\widehat{\text{customers}} = 15 +  2\times\text{temperature}
\tag{9.3}\]</span></span></p>
<p>Igor says “I like this idea too. Its prediction changes smoothly as temperature changes, and it avoids arbitrary cutoffs.”</p>
<p>Dave sounds a cautionary note “This is all great guys, but how do we find the <em>best</em> values for <em>a</em> and <em>b</em>? And what do we mean by <em>good</em> choices?”</p>
<p>Suzie: “I have an idea about how we might define <em>good</em>. Suppose we have a model – let us say for the time being that we use <a href="#eq-kiosk-cust-temp-model-specific" class="quarto-xref">Equation&nbsp;<span>9.3</span></a>. That is, given any temperature, we plug it into <a href="#eq-kiosk-cust-temp-model-specific" class="quarto-xref">Equation&nbsp;<span>9.3</span></a> and it spits out the estimated number of customers.</p>
<p>Suppose we plug in 66 for temperature. <a href="#eq-kiosk-cust-temp-model-specific" class="quarto-xref">Equation&nbsp;<span>9.3</span></a> says the number of customers is 15 + 2*66, or 147. In our data, the number of customers for 66 degrees is 117 for one of the rows where the temperature is 66.”</p>
<p>David’s eyes light up “Oh, we can treat this just like we did earlier and get the penalty by squaring!. This penalty will become 30*30, or 900 for that one row.”</p>
<p>Igor then observes “For any given value of <em>a</em> and <em>b</em>, we can compute the penalty corresponding to each row of the data. With <em>a</em> = 15 and <em>b</em> = 2, we can compute the penalties for each row.” He then worked for a few minutes to come up with penalties for all the rows of <a href="#tbl-temp-customers" class="quarto-xref">Table&nbsp;<span>9.1</span></a> and came up with <a href="#tbl-igor-computations-for-15-2" class="quarto-xref">Table&nbsp;<span>9.2</span></a>.</p>
<div id="tbl-igor-computations-for-15-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-igor-computations-for-15-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.2: Igor’s computations: For each row he plugged in the temperature into <a href="#eq-kiosk-cust-temp-model-specific" class="quarto-xref">Equation&nbsp;<span>9.3</span></a> and computed est_customers (estimated customers by <a href="#eq-kiosk-cust-temp-model-specific" class="quarto-xref">Equation&nbsp;<span>9.3</span></a>) and then computed the squared difference between the actual value of <em>customers</em> and <em>est_customers</em>
</figcaption>
<div aria-describedby="tbl-igor-computations-for-15-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">day</th>
<th style="text-align: right;">temperature</th>
<th style="text-align: right;">customers</th>
<th style="text-align: right;">est_customers</th>
<th style="text-align: right;">diff</th>
<th style="text-align: right;">penalty</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">D01</td>
<td style="text-align: right;">58</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">131</td>
<td style="text-align: right;">-33</td>
<td style="text-align: right;">1089</td>
</tr>
<tr class="even">
<td style="text-align: left;">D02</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">104</td>
<td style="text-align: right;">135</td>
<td style="text-align: right;">-31</td>
<td style="text-align: right;">961</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D03</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">122</td>
<td style="text-align: right;">139</td>
<td style="text-align: right;">-17</td>
<td style="text-align: right;">289</td>
</tr>
<tr class="even">
<td style="text-align: left;">D04</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">113</td>
<td style="text-align: right;">143</td>
<td style="text-align: right;">-30</td>
<td style="text-align: right;">900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D05</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">117</td>
<td style="text-align: right;">147</td>
<td style="text-align: right;">-30</td>
<td style="text-align: right;">900</td>
</tr>
<tr class="even">
<td style="text-align: left;">D06</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">133</td>
<td style="text-align: right;">151</td>
<td style="text-align: right;">-18</td>
<td style="text-align: right;">324</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D07</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">126</td>
<td style="text-align: right;">155</td>
<td style="text-align: right;">-29</td>
<td style="text-align: right;">841</td>
</tr>
<tr class="even">
<td style="text-align: left;">D08</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">115</td>
<td style="text-align: right;">159</td>
<td style="text-align: right;">-44</td>
<td style="text-align: right;">1936</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D09</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">-40</td>
<td style="text-align: right;">1600</td>
</tr>
<tr class="even">
<td style="text-align: left;">D10</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">128</td>
<td style="text-align: right;">167</td>
<td style="text-align: right;">-39</td>
<td style="text-align: right;">1521</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D11</td>
<td style="text-align: right;">78</td>
<td style="text-align: right;">145</td>
<td style="text-align: right;">171</td>
<td style="text-align: right;">-26</td>
<td style="text-align: right;">676</td>
</tr>
<tr class="even">
<td style="text-align: left;">D12</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">141</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">-34</td>
<td style="text-align: right;">1156</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D13</td>
<td style="text-align: right;">58</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">131</td>
<td style="text-align: right;">-25</td>
<td style="text-align: right;">625</td>
</tr>
<tr class="even">
<td style="text-align: left;">D14</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">135</td>
<td style="text-align: right;">-28</td>
<td style="text-align: right;">784</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D15</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">139</td>
<td style="text-align: right;">-34</td>
<td style="text-align: right;">1156</td>
</tr>
<tr class="even">
<td style="text-align: left;">D16</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">127</td>
<td style="text-align: right;">143</td>
<td style="text-align: right;">-16</td>
<td style="text-align: right;">256</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D17</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">120</td>
<td style="text-align: right;">147</td>
<td style="text-align: right;">-27</td>
<td style="text-align: right;">729</td>
</tr>
<tr class="even">
<td style="text-align: left;">D18</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">151</td>
<td style="text-align: right;">-48</td>
<td style="text-align: right;">2304</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D19</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">128</td>
<td style="text-align: right;">155</td>
<td style="text-align: right;">-27</td>
<td style="text-align: right;">729</td>
</tr>
<tr class="even">
<td style="text-align: left;">D20</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">121</td>
<td style="text-align: right;">159</td>
<td style="text-align: right;">-38</td>
<td style="text-align: right;">1444</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D21</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">120</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">-43</td>
<td style="text-align: right;">1849</td>
</tr>
<tr class="even">
<td style="text-align: left;">D22</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">167</td>
<td style="text-align: right;">-37</td>
<td style="text-align: right;">1369</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D23</td>
<td style="text-align: right;">78</td>
<td style="text-align: right;">127</td>
<td style="text-align: right;">171</td>
<td style="text-align: right;">-44</td>
<td style="text-align: right;">1936</td>
</tr>
<tr class="even">
<td style="text-align: left;">D24</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">132</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">-43</td>
<td style="text-align: right;">1849</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D25</td>
<td style="text-align: right;">58</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">131</td>
<td style="text-align: right;">-33</td>
<td style="text-align: right;">1089</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Angela said: “Well the total penalty is 28,312. How do we know if different values for <em>a</em> and <em>b</em> can give us a lower penalty?. In earlier weeks we only had to try different values for one thing. Here we have two things <em>a</em> and <em>b</em> to think about. What do we do?”</p>
<p>Suzie says: “But we have made progress. We have at least clearly defined the problem. We need to find the values for <em>a</em> and <em>b</em> that will give us the lowest possible total penalty along the lines of Igor’s <a href="#tbl-igor-computations-for-15-2" class="quarto-xref">Table&nbsp;<span>9.2</span></a>. That is, we try many different values for &amp;<em>a</em> and <em>b</em> and compute Igor’s table (<a href="#tbl-igor-computations-for-15-2" class="quarto-xref">Table&nbsp;<span>9.2</span></a>) for that combination. We then select the combination taht produces the lowest total penalty. We want the lowest total penalty because that will mean that we have got the model predictions as close as we can to the real values in the data.”</p>
<p>Peter says “Hey, this reminds me of something I saw my dad doing for his work. He always says that visualizing makes things easier. WHy don’t we try that first?””</p>
</section>
</section>
<section id="visualizing-the-model" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="visualizing-the-model"><span class="header-section-number">9.2</span> Visualizing the model</h2>
<p>Peter continued: “Graphically, <a href="#eq-kiosk-cust-temp-model-specific" class="quarto-xref">Equation&nbsp;<span>9.3</span></a> represents a straight line. Let us generate a scatter plot of the data first.” He wrote come code and generated <a href="#fig-kiosk-temp-cust-scatter" class="quarto-xref">Figure&nbsp;<span>9.4</span></a> which showed the relationship between <em>temperature</em> and <em>customers</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>kiosk <span class="sc">|&gt;</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">point_plot</span>(customers <span class="sc">~</span> temperature)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-kiosk-temp-cust-scatter" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-kiosk-temp-cust-scatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../../images/fig-kiosk-temp-cust-scatter.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-kiosk-temp-cust-scatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.4: Scatterplot of <em>temperature</em> against number of <em>customers</em> from the <em>kiosk</em> data frame
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Quick Check">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Quick Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Looking at the scatter plot of temperature versus customers <a href="#fig-kiosk-temp-cust-scatter" class="quarto-xref">Figure&nbsp;<span>9.4</span></a>:</p>
<ul>
<li>Does the relationship appear perfectly linear?</li>
<li>Does that prevent us from using a linear model?</li>
</ul>
<p>Explain briefly.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>The relationship is not perfectly linear; there is noticeable scatter around what seems to be a somewhat linear pattern.</p></li>
<li><p>This does not prevent us from using a linear model. A linear model is a simplification that captures the overall trend, not a claim that all points lie exactly on a line.</p></li>
</ul>
</div>
</div>
</div>
<p>Peter then says: “We have been using <a href="#eq-kiosk-cust-temp-model-specific" class="quarto-xref">Equation&nbsp;<span>9.3</span></a> as our tentative model to explore. In my pre-calculus class, i learned that this is actually the equation of a straight line. I can add it to the earlier plot.”</p>
<p>He then generates <a href="#fig-kiosk-model-initial-attempt" class="quarto-xref">Figure&nbsp;<span>9.5</span></a> which has both the earlier scatter plot and the line from <a href="#eq-kiosk-cust-temp-model-specific" class="quarto-xref">Equation&nbsp;<span>9.3</span></a>. (You need not worry about how he added the line yet. We will learn that shortly.)</p>
<div id="fig-kiosk-model-initial-attempt" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-kiosk-model-initial-attempt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../../images/fig-kiosk-model-initial-attempt.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-kiosk-model-initial-attempt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.5: Adding a line showing the kiosk model with <em>a</em> = 15 and <em>b</em> = 2
</figcaption>
</figure>
</div>
<p>Igor says: “Wow this model is way off the mark! We can reduce the total penalty by a lot.”</p>
<p>Peter smiles: “Please explain to us lesser mortals Igor!”</p>
<p>Try to answer by yourself before reading what Igor has to say.</p>
<p>Igor says: “Well, the line represents the model estimates. If the estimates are good, they will be near the actual points. But our line,representing the estimate for any temperature is way above the general region where the points actually lie! For example, we see from <a href="#fig-kiosk-model-initial-attempt" class="quarto-xref">Figure&nbsp;<span>9.5</span></a> that two days in our historical data have had a temperature of 64 degrees. The number of customers for those two days have been 113 and 127. But the tentative model from <a href="#eq-kiosk-cust-temp-model-specific" class="quarto-xref">Equation&nbsp;<span>9.3</span></a> estimates 143. In fact, we can take any actual row of our data and see that the model estimates are way higher than the general area of the points. Clearly, we did not make great initial choices for <em>a</em> and <em>b</em>! No offense Peter, I know you were just illustrating the form, and not trying to be exact.”</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Quick Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>What can we say about the line if we want the model estimates to be close to the actual values?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Suggested answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The line should be right in the middle of the points as far as possible so that the estimates are close to the actual points.</p>
</div>
</div>
</div>
<p>Angela says: “OK, if we want the model estimates to reflect actual data, we would want the line to be within the point cloud, and perhaps generally go through the middle of the cloud. That would make the estimates at least fall in the general region of the actual values. Let us try again with different choices for <em>a</em> and <em>b</em>. How should we change the values? Should we increase or decrease each one?”</p>
<p>Igor says: “In <a href="#eq-kiosk-cust-temp-model-specific" class="quarto-xref">Equation&nbsp;<span>9.3</span></a> <em>a</em> represents where the line intercepts the y-axis at x = 0. I learned this in my pre-calc class. In that class they called <em>a</em> the <em>intercept</em>.”</p>
<p>Suzie jumped up “I know why. They call it the intercept because that is where the line <em>intersects</em> the y-axis. But in this plot, the line does not stretch all the way to the y-axis because we do not have temperature = 0 in our data.”</p>
<p>Igor: “It does intersect the y-axis, if only we zoom out and show the origin of the plot where x=0 and y=0). Currently the x-axis only starts from around 55.”</p>
<p>Peter quickly modified the plot to show the origin. <a href="#fig-initial-model-with-intercept-visible" class="quarto-xref">Figure&nbsp;<span>9.6</span></a> shows his new plot. This is effectively the same plot as <a href="#fig-kiosk-model-initial-attempt" class="quarto-xref">Figure&nbsp;<span>9.5</span></a>, only zoomed out so that we can see more.</p>
<div id="fig-initial-model-with-intercept-visible" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-initial-model-with-intercept-visible-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../../images/fig-initial-model-with-intercept-visible.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-initial-model-with-intercept-visible-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.6: Model with <em>a</em> = 15 and <em>b</em> = 2 plotted to reveal the origin of the plot so as to see the intercept
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Even though a temperature of 0°F is well outside our data range, visualizing the intercept helps us understand what changing <em>a</em> actually does to the line.</p>
</div>
</div>
<p>Suzie: “From the plot, we can see that the line correctly intersects the y-axis at 15 since <em>a = 15</em>. What can we do to improve the line so that it goes through the points instead of way above them?”</p>
<p>David opines “To make the line go through the point cloud, it looks like we need to make the line less steep, almost like grabbing the top right of the line and pulling it down. How do we achieve that?”</p>
<p>Peter’s pre-calculus comes to the rescue again. “The value for <em>b</em> determines the steepness of the line or its <em>slope</em> also called <em>rise over run</em>. So, we can decrease it to get the line to go through the cloud of points. Perhaps we should decrease it from 2 to 1.5 and see what happens.”</p>
<p>Peter modifies his plot again. <a href="#fig-kiosk-model-second-guess" class="quarto-xref">Figure&nbsp;<span>9.7</span></a> shows his new plot.</p>
<div id="fig-kiosk-model-second-guess" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-kiosk-model-second-guess-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../../images/fig-kiosk-model-second-guess.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-kiosk-model-second-guess-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.7: Second attempt: model with <em>a</em> = 15 and <em>b</em> = 1.5
</figcaption>
</figure>
</div>
<p>Angela says: “Wow! that looks so much better! It goes right through the point cloud. But do we know if it is the <em>best</em> line?”</p>
<p>Igor produced the table for this model and announced: “We have smashed the total penalty from 28312 to 1469! But I still don’t know if that is the lowest possible. Maybe there are other values of <em>a</em> and <em>b</em> that can reduce it even more.”</p>
<p>Peter, tired of generating more and more plots, says “We can keep on trying – we have an infinite number of choices for <em>a</em> and <em>b</em>. How do we find the <em>best</em> values for <em>a</em> and <em>b</em> that produce the <em>best line? What does </em>best* even mean?</p>
</section>
<section id="what-do-we-mean-by-the-best-model" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="what-do-we-mean-by-the-best-model"><span class="header-section-number">9.3</span> What do we mean by the <em>best</em> model?</h2>
<p>In the previous section, the team tried a few values for <em>a</em> and <em>b</em> and their second attempt proved to be much better than the first. However, we want the <em>best</em> line. But what does that mean?</p>
<p>David says “Actually, before visualizing the models, we had already identified what we mean by <em>best</em>. We had already established that the <em>best</em> model or <em>line</em>, is the one that generates the lowest total penalty as we computed in <a href="#tbl-igor-computations-for-15-2" class="quarto-xref">Table&nbsp;<span>9.2</span></a>. That is, we choose the values for <em>a</em> and <em>b</em> and mimic the process we used for <span class="citation" data-cites="btl-igor-computations-for-15-2">@btl-igor-computations-for-15-2</span> and choose the values that produce the smallest total penalty. But how do we do that when we have an infinite number of possibilities.”</p>
<p>Angela says: “Can we not repeat what Suzie did and generate a plot for various values and visually see what the best values are?”</p>
<p>Peter says: “Guys, before we think about that, I can help to visualize the sort of computations we did in <a href="#tbl-igor-computations-for-15-2" class="quarto-xref">Table&nbsp;<span>9.2</span></a> but for the line in <a href="#fig-kiosk-model-second-guess" class="quarto-xref">Figure&nbsp;<span>9.7</span></a>.” and comes up with <a href="#fig-tentative-model-with-residuals-visualized" class="quarto-xref">Figure&nbsp;<span>9.8</span></a>.</p>
<p>He goes on to explain: “We are after a model that produces <em>good</em> estimates. Therefore the difference between the actual value and the model estimate (the column <em>diff</em> in <a href="#tbl-igor-computations-for-15-2" class="quarto-xref">Table&nbsp;<span>9.2</span></a>) matters. The lower that difference is, the better.” He then generates <a href="#fig-tentative-model-with-residuals-visualized" class="quarto-xref">Figure&nbsp;<span>9.8</span></a> to visualize the previous model (<em>a</em> = 15 and <em>b</em> = 1.5) with the differences between the actual values and model predictions explicitly marked for three chosen points. These differences are usually called <em>errors</em> or even better, <em>residuals</em>.</p>
<div id="fig-tentative-model-with-residuals-visualized" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tentative-model-with-residuals-visualized-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../../images/fig-tentative-model-with-residuals-visualized.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tentative-model-with-residuals-visualized-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.8: Model with <em>a</em> = 15 and <em>b</em> = 1.5 visualized along with the <em>residual</em> or error for three chosen points
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-warning callout-titled" title="Common Misconception">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Common Misconception
</div>
</div>
<div class="callout-body-container callout-body">
<p>The error or <em>residual</em> for an estimate is <strong>not</strong> the shortest distance to the line. It is the <strong>vertical difference</strong> between the observed value and the estimated value. This is because our model estimates the response (customers) and we compare that to the actual number of customers for any point.</p>
</div>
</div>
<p>David points to <a href="#fig-tentative-model-with-residuals-visualized" class="quarto-xref">Figure&nbsp;<span>9.8</span></a> and says: “For the point at <em>temperature</em> = 62, the actual data had <em>customers</em> = 105, whereas our model estimates 108. So the model is off by -3 (if we compute the residual using this equation.” and he writes out <a href="#eq-residual-1" class="quarto-xref">Equation&nbsp;<span>9.4</span></a>.</p>
<p><span id="eq-residual-1"><span class="math display">\[
\text{residual} = \text{actual value} - \text{model prediction}
\tag{9.4}\]</span></span></p>
<p>Peter continues: ““For the data point with <em>temperature</em> = 68, the model estimates 116, whereas the actual value was 132 for a residual of +16. Finally, for the point where the <em>temperature</em> is 76, the model estimates 129, whereas the actual value was 130. The model did well on this point. In this way, we can compute the <em>residual</em> for every point and square it. We are not particularly concerned about the actual sign of the residual since we are going to square it anyway. This is exactly what Igor showed us in <a href="#tbl-igor-computations-for-15-2" class="quarto-xref">Table&nbsp;<span>9.2</span></a>.”</p>
<div class="callout callout-style-default callout-note callout-titled" title="Quick Check">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Quick Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>If a model estimates 120 customers for a given temperature, and the actual number is 132:</p>
<ul>
<li>What is the residual or error in this estimate?</li>
<li>Is it positive or negative?</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The estimate’s error is 132 − 120 = 12.</p>
<p>The error is positive because the actual value is higher than the estimated value.</p>
</div>
</div>
</div>
<p>Angela says: “If we draw any line through these points, each line will have low <em>absolute residuals</em> for some points and higher ones for others. But we have many points and so we want an <em>overall measure of how close the line is to </em>all the points* by considering all the <em>absolute residuals</em>. Even if a line is spot-on for a few points, it is not very useful if it is wildly off for many others. That overall measure is in fact the total penalty from <a href="#tbl-igor-computations-for-15-2" class="quarto-xref">Table&nbsp;<span>9.2</span></a>. It is very nice that we have seen the computations and also seen its visualization to make sure we understand all this. I sure am glad we are doing this as a team!”</p>
<p>Igor says, “Yes, now I too see the connection between my table (<a href="#tbl-igor-computations-for-15-2" class="quarto-xref">Table&nbsp;<span>9.2</span></a>) and Peter’s visualization of the concept. So, we will square the residuals from all the points and add them all up. That is how much total penalty the line/model has when we consider <em>all</em> data points. As Amanda wanted, squaring punishes bigger residuals much more than smaller ones. I have heard that this is a standard theme in statistics.”</p>
<div class="callout callout-style-default callout-warning callout-titled" title="What's the deal with squaring?">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What’s the deal with squaring?
</div>
</div>
<div class="callout-body-container callout-body">
<p>We square errors for the same reason we used squared deviations when defining variance:</p>
<ul>
<li>positive and negative errors should not cancel out</li>
<li>larger errors should count more than smaller ones</li>
</ul>
<p>Least squares regression that we study in this course is built on the same logic as variance. In a later chapter, we will see this idea pop when we look at the explanatory power of a model. Hang tight till then!</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Quick Check">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Quick Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Why don’t we choose the line that minimizes the <strong>sum of errors</strong> instead of the <strong>sum of squared errors</strong>?</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Positive and negative errors would cancel out if we summed errors directly.</p>
<p>Squaring errors ensures that all errors contribute positively and that larger errors are penalized more heavily.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Quick Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>In what sense is the line in <a href="#fig-tentative-model-with-residuals-visualized" class="quarto-xref">Figure&nbsp;<span>9.8</span></a> better than the one in <a href="#fig-initial-model-with-intercept-visible" class="quarto-xref">Figure&nbsp;<span>9.6</span></a>?</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Suggested answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The line in <a href="#fig-tentative-model-with-residuals-visualized" class="quarto-xref">Figure&nbsp;<span>9.8</span></a> is much closer to each of the points than the one in <a href="#fig-initial-model-with-intercept-visible" class="quarto-xref">Figure&nbsp;<span>9.6</span></a>. Consequently it will have much lower residuals for almost any point.</p>
</div>
</div>
</div>
<p>David says: “For this model (a = 15, b = 1.5), the total of all the squared residuals is: 1,469. Is there a line that can give an even lower value? What are the values for <em>a</em> and <em>b</em> for which we get the <em>lowest</em> possible total of all the squared residuals?”</p>
<p>The team now understands exactly what they mean by the <em>best</em> model. They are looking for values for <em>a</em> and <em>b</em> that will result in the lowest total penalty. But they are stuck on to how to actually get it.</p>
<p>Catching the thread about trying to generate a plot to identify the best values just like Suzie did in the first week, Angela returns to her idea. “Suzie, can you do you pull off your plotting magic again, please?”</p>
<p>Suzie: “Well angela, that would be a three-dimensional plot because we will have <em>a</em>, <em>b</em>, and the <em>total penalty</em> all on the same plot. I can do it, but I am afraid it will not be much help.”</p>
<p>Igor: “Wht not just print out a large table of all combinations of <em>a</em> and <em>b</em> and the total penalty for each combination? We can then look through the table and select the best value – or even ask the program to look through the table and find the values for us?”</p>
<p>Suzie says “We can Igor, but I have two issues. Firstly, when I try the various combinations of <em>a</em> and <em>b</em>, I can only do it in some intervals like 0.1 or something like that. What if the best solution was between two of my values? We will then not get an exact solution, but we will get something very close. A bigger problem is what if Amanda comes up with two more variables to use in our predictions? Then trying all combinations can generate a very large number of rows, perhaps millions. There has to be a better way.”</p>
<p>Steve, who has been silent for a long time has actually been having a nagging feeling that he has done something similar in one of his classes. He now says “I think we learned something like this in my econ class. Rather than making Suzie write a whole new program, I think there is a function in R, based in calculus that can readily do this for us! Let me try.”</p>
<p>And he runs the code below: which generates the <em>best</em> values for <em>a</em> and <em>b</em> that guarantee that the <em>sum of squared residuals</em> is the smallest possible.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>kiosk <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_train</span>(customers <span class="sc">~</span> temperature) <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) temperature 
      22.06        1.42 </code></pre>
</div>
</div>
<p>Steve then explains: “Ah, now I remember what the output means. We see two values in the output: <em>intercept</em> and <em>temperature</em>. The first is <em>a</em> and the second is <em>b</em>! These are exactly the values of <em>a</em> and <em>b</em> that minimize the sum of squared residuals. These are the values that give us the <em>best</em> possible line!”</p>
<p>From the output, Steve then writes the model equation <a href="#eq-kiosk-cust-temp-model-best" class="quarto-xref">Equation&nbsp;<span>9.5</span></a>, and says:</p>
<p>“This equation shows the <em>best model</em> for our problem, given that we want a straight line and want to minimize the sum of squared residuals.”</p>
<p>“Our econ teacher called this the least-squares regression line.”</p>
<p><span id="eq-kiosk-cust-temp-model-best"><span class="math display">\[
\widehat{\text{customers}} = 22.06 +  1.42\times\text{temperature}
\tag{9.5}\]</span></span></p>
<div class="callout callout-style-default callout-note callout-titled" title="Key Idea">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Idea
</div>
</div>
<div class="callout-body-container callout-body">
<p>Since there is an infinite number of possible choices for <em>a</em> and <em>b</em>, we need a systematic way to find the values that minimize the total of the squared residuals. Mathematically, this problem can be solved using calculus. Practically, we sit back and let software do this for us.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Pause &amp; Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pause &amp; Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Complete the sentence:</p>
<p>“A least squares regression line is the line that _____.”</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A least squares regression line is the line that minimizes the sum of squared vertical estimation errors, or the sum of squared residuals (same thing).</p>
</div>
</div>
</div>
<p>Igor is at it again. He announces “The total penalty for this is 1388. This beats the 1469 we got earlier. And, according to Steve, this is the <em>best</em>. I am quite impressed that we had eyeballed a solution very close to the best!”</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The team found a line that <em>minimizes the sum of squared residuals</em>. Technically this is called the <em>least-squares criterion</em> and plays a very important role in statistics and data analysis.</p>
</div>
</div>
<p>They explained the model to Amanda. After a lot of questioning to understand their decision criteria, Amanda agreed to use this model for the next month.</p>
<p>Amanda was thrilled with their work. “Great work team. Talk to me when you graduate. I want to assemble a business analytics team for my businesses and I sure can do with a team like yours. You might not be from Harvard or MIT. All I care about is that you are able to apply your learnings to business problems and are willing to think through things with a clear head.”</p>
<div class="callout callout-style-default callout-note callout-titled" title="Pause &amp; Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pause &amp; Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Suppose tomorrow’s high temperature is 73°F. Your model estimates 124 customers.</p>
<ul>
<li>Does this mean exactly 124 customers will arrive?</li>
<li>What other factors (besides temperature) might cause the actual number to be higher or lower?</li>
</ul>
<p>What does this tell you about what a regression model can, and cannot, do?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Suggested answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>No.&nbsp;124 is only a model estimation. In reality the number of customers may be 124 or higher or lower.</p></li>
<li><p>The model acts as if only the temperature determines the number of customers. In reality, many other factors play a role too. Perhaps there is a football game in town and that draws people away. Perhaps the humidity is unusually high and people stay away. Many factors play a role in this. Our model uses a simple rule that can potentially perform decently without being accurate and overly complex.</p></li>
</ul>
<p>In later chapters we will see that we can include more variables in a model and improve its performance.</p>
</div>
</div>
</div>
<section id="optional-enrichment-topic-beyond-straight-lines" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="optional-enrichment-topic-beyond-straight-lines"><span class="header-section-number">9.4</span> Optional enrichment topic: Beyond straight lines</h2>
<p>In this chapter, we have assumed that a straight line is a reasonable model for the relationship between temperature and customer traffic. In many business settings, this assumption works well: simple models are easy to interpret, easy to communicate, and often good enough for decision-making.</p>
<p>However, not all relationships are well captured by a straight line.</p>
<section id="when-a-straight-line-may-not-be-appropriate" class="level3" data-number="9.4.1">
<h3 data-number="9.4.1" class="anchored" data-anchor-id="when-a-straight-line-may-not-be-appropriate"><span class="header-section-number">9.4.1</span> When a straight line may not be appropriate</h3>
<p>In some situations, a scatter plot may reveal patterns such as:</p>
<ul>
<li><p>curvature (the relationship bends),</p></li>
<li><p>diminishing returns (the effect of increases slows down), or</p></li>
<li><p>threshold effects (behavior changes after a certain point).</p></li>
</ul>
<p>For example, at very high temperatures, customer traffic at a beach kiosk might level off or even decline as conditions become uncomfortable. A straight line cannot capture this kind of behavior well, no matter how its slope and intercept are chosen.</p>
<p>In such cases, forcing a linear model may lead to systematic residual patterns, indicating that the model is missing something important.</p>
</section>
<section id="a-flexible-alternative-lowess-smoothing" class="level3" data-number="9.4.2">
<h3 data-number="9.4.2" class="anchored" data-anchor-id="a-flexible-alternative-lowess-smoothing"><span class="header-section-number">9.4.2</span> A flexible alternative: LOWESS smoothing</h3>
<p>One way to explore nonlinear relationships is through a technique called LOWESS (short for locally weighted scatter plot smoothing).</p>
<p><a href="#fig-lowess-example" class="quarto-xref">Figure&nbsp;<span>9.9</span></a> shows an example of a LOWESS model using the <em>mpg</em> data frame. In this data frame the <em>displacement</em> of an engine is related to the highway mileage <em>hwy</em>, but not in a linear way. The LOWESS model better describes it than a straight line would. Like the earlier line model, this too can take in a value for <em>displ</em> and provide an estimated value for <em>hwy</em>.</p>
<div id="fig-lowess-example" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lowess-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../../images/fig-lowess-example.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lowess-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.9: LOWESS model for <em>displacement</em> vs <em>cty</em> in the <em>mpg</em> data frame showing how it captures the curvature in the relationship better than a lien can
</figcaption>
</figure>
</div>
<p>Rather than fitting a single global rule like a straight line, LOWESS works by:</p>
<ul>
<li><p>focusing on a small neighborhood of points around each value of the explanatory variable, and</p></li>
<li><p>fitting simple local models that adapt to the data in that neighborhood.</p></li>
</ul>
<p>The result is a smooth curve that follows the overall pattern of the data without requiring us to specify a particular functional form in advance.</p>
<p>LOWESS is especially useful for:</p>
<ul>
<li><p>exploratory analysis,</p></li>
<li><p>visualizing trends, and</p></li>
<li><p>diagnosing whether a straight-line model is reasonable.</p></li>
</ul>
<p>It is not intended to replace regression models in all cases, but rather to help us understand the structure of the data.</p>
</section>
<section id="models-as-choices-not-defaults" class="level3" data-number="9.4.3">
<h3 data-number="9.4.3" class="anchored" data-anchor-id="models-as-choices-not-defaults"><span class="header-section-number">9.4.3</span> Models as choices, not defaults</h3>
<p>The key takeaway is not that linear models are “wrong,” but that models are choices.</p>
<ul>
<li><p>A straight line is a good choice when the relationship is approximately linear and interpretability matters.</p></li>
<li><p>A nonlinear model may be a better choice when the data clearly suggest curvature or changing behavior.</p></li>
<li><p>Flexible tools like LOWESS help us see what the data are trying to tell us before we commit to a specific model.</p></li>
</ul>
<p>In all cases, the central modeling question remains the same:</p>
<blockquote class="blockquote">
<p>Does this model capture the important structure in the data well enough to support the decisions we want to make?</p>
</blockquote>
<p>This mindset—treating models as purposeful approximations rather than automatic formulas—will guide us throughout the rest of this book.</p>


</section>
</section>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../modules/04-more-on-models/04-overview.html" class="pagination-link" aria-label="Module 4: Linear Regression Models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Module 4: Linear Regression Models</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../modules/04-more-on-models/visualizing-models.html" class="pagination-link" aria-label="Visualizing Models">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Visualizing Models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>