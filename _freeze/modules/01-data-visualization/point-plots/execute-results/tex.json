{
  "hash": "edcd7848cc584a0526579675d25c5f69",
  "result": {
    "engine": "knitr",
    "markdown": "---\neditor: \n  markdown: \n    wrap: 72\n---\n\n# Exploring Relationships through Scatterplots\n\nThis chapter covers the basics of generating and interpreting\nscatterplots.\n\nThe term *statistics* often conjures up thoughts of numerical\ncomputations. However, before we perform various computations, we often\nget a feel for the data and the underlying patterns by first visualizing\nthe data. In this course we will use only a few standard plots to\ncommunicate essential statistical ideas.\n\nIn fact, use a single function -- *point_plot* -- to generate all of our\nplots. Although R offers numerous, sophisticated plotting features to\nplot almost anything we can imagine, we will keep things simple and\nfocus only on what we need to support the concepts that our course\ncovers.\n\n## Learning outcomes {.unnumbered}\n\n**Interpret point plots** - Explain what a point means (x value and y\nvalue). - Map between plot ↔ row in a data frame. - Describe\ndirection/strength/absence of relationship.\n\n**Use R to generate point plots**\n\n- Use point_plot(y \\~ x) for numeric–numeric and point_plot(y \\~\n    x_cat) for numeric–categorical.\n- Use + color_var and + facet_var in the formula.\n\n**Explain and interpret correlation** - Explain what correlation\nmeasures (direction + strength of linear association) and interpret\nsign/magnitude.\n\n## Plotting the relationship between two numerical variables\n\nWe will rely extensively on a single plotting function named\n*point_plot()*. It lives in the *LSTbook* package. We will be loading\nboth the *LSTbook* package and the *LSTextra*s package. Once we load\nthese packages the *point_plot()* function becomes available for us to\nuse.\n\nLet us first look at the *price_demand* data frame that is built into\nthe *LSTextras* package and is therefore available as soon as you load\nthe package.\n\nA hypothetical company has gathered data for a single product. Over\ntime, and across very similar sales areas, the company has charged\ndifferent prices for the same product, It has recorded the monthly sales\nfor each price. The data frame *price_demand* contains the price and the\ncorresponding sales quantities. We would like to study if the two\nvariables *price* and *sales_qty* are related in any way.\n\nFirst let us see some rows from the data frame.\n\n\n::: {#tbl-price-demand .cell tbl-cap='Price Demand data (first 15 rows)'}\n::: {.cell-output-display}\n\n\\begin{longtable}[t]{rr}\n\\toprule\nprice & sales\\_qty\\\\\n\\midrule\n11.8 & 1260\\\\\n12.1 & 1215\\\\\n13.6 & 1214\\\\\n12.3 & 1298\\\\\n12.4 & 1160\\\\\n\\addlinespace\n13.7 & 1138\\\\\n12.6 & 1174\\\\\n11.2 & 1220\\\\\n11.7 & 1313\\\\\n11.9 & 1283\\\\\n\\addlinespace\n13.3 & 1170\\\\\n12.6 & 1247\\\\\n12.6 & 1283\\\\\n12.3 & 1263\\\\\n11.8 & 1259\\\\\n\\bottomrule\n\\end{longtable}\n\n\n:::\n:::\n\n\nThe full data frame has 500 rows. With so many rows, we cannot easily\nget a handle on the overall pattern by looking at the data directly.\nVisualizing the data might help us. We will do several things in this\nsection:\n\n-   generate the plot using R code\n-   understand how each element of the plot is related to the original\n    data frame\n-   understand the various elements of the code so that you can use\n    similar code to generate plots that you many need\n-   interpret the plot\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nIn the *price_demand* data frame, what does one row represent?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nThe price charged during a particular month and the corresponding sales quantity..\n:::\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nIn the *price_demand* data frame, which variable does a company have\ncontrol over or that it can set and which one is the outcome variable?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\n*price* is the input/explanatory variable; *sales quantity* is the\noutcome/response\n:::\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nIf the data frame has 500 rows, how many (price, sales_qty) pairs exist?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\n500\n:::\n\nThe code and the plot appear below. For now, ignore the code. We will\ndiscuss it in detail after analyzing the plot itself.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprice_demand |> \n  point_plot(sales_qty ~ price)\n```\n\n::: {.cell-output-display}\n![Price demand relationship](point-plots_files/figure-pdf/fig-price-demand-1.pdf){#fig-price-demand fig-pos='H'}\n:::\n:::\n\n\n@fig-price-demand shows the relationship between *price* and\n*sales_qty*.\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\n@fig-price-demand which variable appears on the x-axis and which one on\nthe y-axis?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nx-axis: *price* y-axis: *sales_qty*\n:::\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nWhat two numbers determine the location of a point in @fig-price-demand?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nIts x-value (*price*) and its y-value (*sales_qty*)\n:::\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nIf a point is at x = 14 and y = 1100, what does it mean in context?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nThere was an observation (row in the *price_demand* data frame) where\nthe price was about 14 and the monthly sales quantity was about 1100.\n:::\n\nNote the following about the plot:\n\n-   The plot has two axes -- the x-axis along the width and the y-axis\n    along the height.\n-   The plot shows the values of price on the x-axis and the values of\n    sales_qty on the y-axis.\n-   If you take any single point on the plot, you can drop a vertical\n    line from the point to the x-axis and the point where it intersects\n    the x-axis is the *price* corresponding to the point.\n-   Similarly, if you draw a horizontal line from the point to intersect\n    the y-axis, you get the *sales_qty* corresponding to that point.\n-   Each point of the plot corresponds to one row of the data frame. So\n    how many points are on the plot? 500, since the data frame has 500\n    rows.\n-   Thus given a point on the plot, we should be able to identify a\n    corresponding row of the data frame\n-   Given a row of the data frame, we should be able to identify a\n    corresponding point on the plot.\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nTrue or False: Two different rows can produce the exact same point.\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nTrue. If two rows have identical price and sales_qty, they would overlap\nat the same location.\n:::\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nIf you see an extreme point far above the rest, what does that imply\nabout its row in the data frame?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nThe row on which the point is based has an unusually high sales_qty\nvalue relative to the others (for its price).\n:::\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nWhy might it be hard to identify the exact row for a point just from the\nplot?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nMany points can be close together or overlapping, and the plot shows\napproximate positions rather than exact values.\n:::\n\n### Finding the point corresponding to a row of the data frame\n\nLet us now try to find the point on the plot corresponding to the first\nrow in @fig-price-demand.\n\nThe first row of the data frame has *price = 11.8* and *sales_qty =\n1260*. Therefore, we can find the point by drawing a vertical line from\n11.8 on the x-axis to intersect a horizontal line from 1260 on the\ny-axis. @fig-first-row-price-demand-on-plot illustrates this. We have\nhighlighted the point by enlarging it.\n\n![Finding the first row of the *price_demand* data frame on the plot:\n*price = 11.8*, *sales_qty =\n1260*](../../images/fig-first-row-price-demand-on-plot.png){#fig-first-row-price-demand-on-plot\nwidth=\"70%\" fig-align=\"center\"}\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nSuppose a row has *price = 12.5* and *sales_qty* = 1200. Describe how to\nlocate its point on the plot.\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nFind 12.5 on the x-axis, move up to where y is 1200, and mark the\nintersection.\n:::\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nIf you draw a vertical line at *price* = 13, you will cut through\nseveral points. What is common to all of these?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nThey all correspond to rows that have *price* = 13.\n:::\n\nSimilarly, let us locate the point corresponding to row 11 (*price =\n13.3*, *sales_qty = 1170*).\n\nfollowing the same approach we arrive at\n@fig-eleventh-row-price-demand-on-plot.\n\n![Finding the eleventh row of the *price_demand* data frame on the plot:\n*price = 13.3*, *sales_qty =\n1170*](../../images/fig-eleventh-row-price-demand-on-plot.png){#fig-eleventh-row-price-demand-on-plot\nwidth=\"70%\" fig-align=\"center\"}\n\n### Finding the *price* and *sales_qty* corresponding to a point on the plot\n\nWe can reverse the above process to find the variable values (and hence\nthe actual row) corresponding to a point on the plot. We will simply\ndrop a vertical line from the point down to the x-axis to get the\n*price* and draw a horizontal line from the point to the y-axis to\ndetermine the *sales_qty*. The figure will look similar to the prior two\nfigures.\n\n### Dissecting the code\n\n@fig-first-point-plot-code decodes the various elements of the code that\nwe used to generate out first point plot in @fig-price-demand. We see\nthat we pass the data frame *price_demand* to the *point_plot* function\nthrough the *pipe* operator. We add the tilde expression for the plot as\nan additional argument.\n\n@fig-basic-tilde-expression shows us that the *point_plot* function maps\nthe variable on the left of the tilde operator to the y-axis of the plot\nand maps the variable to the right of the tilde expression to the x-axis\nof the plot.\n\n![Passing the *price_demand* data frame as argument to the *point_plot*\nfunction through the pipe\noperator](../../images/fig-first-point-plot-code.png){#fig-first-point-plot-code\nwidth=\"70%\" fig-align=\"center\"}\n\n![Using a tilde expression to map variables to the\naxes](../../images/fig-basic-tilde-expression.png){#fig-basic-tilde-expression\nwidth=\"70%\" fig-align=\"center\"}\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nIn a y \\~ x formula for point_plot, what does the tilde mean\noperationally?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nIt separates the y-variable (left) from the x-variable (right), mapping\nthem to the plot axes.\n:::\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nWrite the formula you would use to plot weekly_sales_k on the y-axis\nagainst advertising_spend_k on the x-axis. Write only the tilde\nexpression.\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nweekly_sales_k \\~ advertising_spend_k\n:::\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nIf you accidentally write price \\~ sales_qty, what changes in the\nappearance of the plot?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nThe axes swap: price becomes the y-axis and sales quantity becomes the\nx-axis.\n:::\n\n### Interpreting the plot\n\n@fig-price-demand-2 repeats the plot of *price* versus *sales_qty*.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprice_demand |> \n  point_plot(sales_qty ~ price)\n```\n\n::: {.cell-output-display}\n![Price demand relationship (again)](point-plots_files/figure-pdf/fig-price-demand-2-1.pdf){#fig-price-demand-2 fig-pos='H'}\n:::\n:::\n\n\nWe can see a clear trend showing that, in general, higher prices\ncorrespond to lower values of sales quantity.\n\nTo be sure, this is only a trend and not a strict rule. That is, given\nany two points, we do not have a guarantee that the point with the\nhigher price will always have a lower sales quantity. However, this will\nbe true for most of the pairs of points.\n@fig-scatter-with-line-segments-1 illustrates this with some randomly\nselected pairs of points. We see that most of the lines point down and\nto the right -- meaning that for most pairs of points, the one with\nhigher *price* has a lower *sales_qty*. However, we also see a few\nexamples where the opposite is true.\n\nThis is why we only calls this a *trend* and not a strict rule about the\nrelationship between price and sales_qty.\n\n![Line segments connecting some pairs of points showing that for most\npairs of points the point with higher price has lower\nsales_qty](../../images/fig-scatter-with-line-segments-1.png){#fig-scatter-with-line-segments-1\nwidth=\"70%\" fig-align=\"center\"}\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nDescribe a quick visual procedure to decide if the relationship is\npositive, negative, or neither.\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nLook at the overall slope of the cloud from left to right: up =\npositive, down = negative, no slope = neither.\n:::\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nIn the price vs sales plot, why do we call it a trend and not a rule?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nBecause points vary; higher price usually means lower sales, but not for\nevery single pair of observations.\n:::\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nWhat would a “no linear relationship” scatterplot look like?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nA roughly pattern less cloud with no clear upward or downward slope.\n:::\n\n### Positive and negative relationships\n\nIn general, when we discuss the relationship between two numerical\nvariables, if the general trend is that higher values of one correspond\nto higher values of the other, then we have a positive relationship. On\nthe other hand, is higher values of one variable correspond to lower\nvalues of the other then we have a negative relationship.\n\nWhat kind of relationship does @fig-price-demand-2 show -- positive or\nnegative?\n\nYou got it right if you said *negative* -- higher values of *price*\ncorrespond to lower values of *sales_qty*.\n\n@fig-advertising-sales-channel-1 shows two positively correlated\nvariables. Here, higher values of one variable are generally related to\nhigher values of the other. We used the *advertising_sales_channel* data\nframe for this plot.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nadvertising_sales_channel |> \n  point_plot(weekly_sales_k ~ advertising_spend_k)\n```\n\n::: {.cell-output-display}\n![Weekly sales and advertising spend have a positive relationship -- higher advertising generally has higher weekly sales](point-plots_files/figure-pdf/fig-advertising-sales-channel-1-1.pdf){#fig-advertising-sales-channel-1 fig-pos='H'}\n:::\n:::\n\n\nThe data frame *returns_dpo* contains hypothetical data on various\nfirms' daily stock returns and the number of days they take to pay their\nsuppliers. @fig-returns-dpo-1 shows the relationship between these\nvariables. We cannot spot any trend. Higher or lower values of one\nvariable do not indicate higher or lower values of the other. Hence\nthere is neither a positive relationship nor a negative one.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreturns_dpo |> \n  point_plot(daily_return ~ dpo)\n```\n\n::: {.cell-output-display}\n![Days payment outstanding (dpo) does not have a relationship to the daily stock return](point-plots_files/figure-pdf/fig-returns-dpo-1-1.pdf){#fig-returns-dpo-1 fig-pos='H'}\n:::\n:::\n\n\n**How to decide visually if there’s a relationship**\n\nImagine the point cloud as a blob\n\n*Ask:* does it slope up, slope down, or neither? *Ask:* tight blob or\nwide blob?\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nLabel each plot as positive, negative, or no clear relationship: (a)\nprice vs sales_qty, (b) advertising vs weekly sales, (c) dpo vs daily\nreturn.\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\n(a) negative, (b) positive, (c) no clear relationship.\n:::\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nIf a scatterplot has a positive relationship, what do you expect most\nleft-to-right line segments between random pairs of points to do?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nPoint up and to the right.\n:::\n\n### Putting a number on the relationship: The correlation coefficient\n\nThus far, we have been talking about relationships between variables.\nExact sciences like mathematics and statistics like to be precise and\nassign numbers where possible. Statistics commonly uses the *correlation\ncoefficient* to quantify the relationship between two numerical\nvariables. This section just introduces the *correlation coefficient*\nand shows you how to compute it using R. We will get into the mechanics\nof the actual computation later in the book.\n\nThe correlation coefficient can take a value between -1 and +1. A value\nof 0 signifies *no linear relationship*. -1 signifies a perfect negative\ncorrelation and +1 signifies a perfect positive correlation. We discuss\nthese ideas below.\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nWhat does the sign of the correlation coefficient tell you?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nDirection: positive means upward trend (as we go to the right); negative\nmeans downward trend (as we go to the right).\n:::\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nWhat does the magnitude (absolute value, that is, value without the\nsign) tell you?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nStrength of the linear pattern: closer to 1 means points lie closer to a\nstraight line.\n:::\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nTrue or False: r = 0 proves there is no relationship of any kind.\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nFalse. It indicates no *linear relationship*; there could still be a\ncurved or other non-linear relationship. We show an example later.\n:::\n\nWe look at some examples now. Revisiting the *price_demand* data frame,\nlet us use R to compute the correlation coefficient between the\nvariables *price* and *sales_qty*.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprice_demand |> \n  summarize(price_sales_qty_correlation = cor(price, sales_qty))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 x 1\n  price_sales_qty_correlation\n                        <dbl>\n1                      -0.752\n```\n\n\n:::\n:::\n\n\nWe are computing a summary and hence use the *summarize* function (see\n@sec-summarize-function). Since the summary we are computing now is the\ncorrelation coefficient, we use the *cor* function within the\n*summarize* function. We have chosen to call the computed result\n*price_sales_qty_correlation*. We could have named it anything we\nwanted, but chose the sensible approach of giving it a meaningful name.\n\n@fig-price-demand had already shown us the negative relationship between\n*price* and *sales_qty*. The correlation confirms it, ... and makes it\nmore precise.\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nIf the scatterplot slopes down and the correlation is -0.75, do these\nagree?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nYes. Negative sign matches the downward trend; 0.75 magnitude suggests a\nfairly strong linear relationship.\n:::\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nIf two variables have correlation coefficient close to +1, what will the\nscatterplot look like?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nPoints clustered tightly around a line sloping upward.\n:::\n\nLet us compute the correlation coefficient between advertising spend and\nthe weekly sales from the *advertising_sales_channel* data frame. From\n@fig-advertising-sales-channel-1 we saw that these two variables are\npositively related. Let us see what the correlation coefficient says.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nadvertising_sales_channel |> \n  summarize(ad_sales_corr = cor(advertising_spend_k, weekly_sales_k))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 x 1\n  ad_sales_corr\n          <dbl>\n1         0.760\n```\n\n\n:::\n:::\n\n\nSure enough, we see a positive correlation coefficient.\n\n### Perfect correlation\n\nConsider @fig-price-demand-3 showing strong, but imperfect, correlation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprice_demand |> \n  point_plot(sales_qty ~ price)\n```\n\n::: {.cell-output-display}\n![Price and sales_qty are not perfectly correlated -- correlation coefficient is -0.75 ](point-plots_files/figure-pdf/fig-price-demand-3-1.pdf){#fig-price-demand-3 fig-pos='H'}\n:::\n:::\n\n\nWe have already established that *price* and *sales_qty* are negatively\nrelated. That is, there is a general pattern that higher values of\n*price* have lower values of *sales_qty*.\n\nIn @fig-price-demand-3, if we look only at the points corresponding to a\nparticular value of *price*, say 13, the points along this vertical line\nrange from approximately 1100 to 1320. That is, given a value of\n*price*, we cannot be sure about the exact value of the corresponding\nvalue of *sales_qty*. However, knowing *price* does give us some idea\nabout *sale_qty*. This shows relationship, but not perfect correlation.\n\nWhen the correlation coefficient is +1 or -1, we have perfect\ncorrelation. In this case, knowing the value of one variable enables us\nto precisely know the value of the other variable as well. This happens\nwhen all the points lie on a straight line instead of being dispersed as\na cloud as in @fig-price-demand-3.\n\n![Perfect correlation arises when all the points lie perfectly on a\nstraight line -- the variables in this plot have a correlation\ncoefficient of\n+1](../../images/fig-production-cost-units-produced.png){#fig-production-cost-units-produced\nwidth=\"70%\" fig-align=\"center\"}\n\n@fig-production-cost-units-produced shows a situation when all points\nlie on a perfect straight line. In this case, given a value for one\nvariable, we can determine exactly the value of the other. We can\ndetermine it visually or by plugging the value of the known variable\ninto the following equation and calculating the value of the other\nvariable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntotal_cost = 10000 + 45*units_produced\n```\n:::\n\n\nIn @fig-production-cost-units-produced the line slopes upward as it goes\nfrom left to right. When the line on which all points fall slopes down\nas it goes right, the correlation is still perfect, but the line slopes\ndown as it goes to the right and so we have a correlation coefficient of\n-1.\n\n### How the point cloud looks for various correlation coefficients\n\n@fig-various-corr-coeffs shows the point plots for various values of\ncorrelation coefficients between -1 and +1.\n\n![Point plots for various correlation-coefficients\n(r)](../../images/fig-various-corr-coeffs.png){#fig-various-corr-coeffs\nwidth=\"70%\" fig-align=\"center\"}\n\nYou can see the following: - in the plot with correlation coefficient =\n-1 (r = -1), the points align perfectly on a straight line *sloping\ndownwards* as the x values increase - at +1 they align perfectly on a\nline *sloping upwards* as the x values increase - as the coefficient\ngoes from -1 to 0, the points get more scattered away from perfect\nalignment on a straight line until at 0 there is no pattern whatsoever -\nas the correlation coefficient increases from 0 to +1, we see that the\ntendency to align on a straight line increases until perfect alignment\nat r = 1.\n\n::: callout-important\n## Magnitude and sign of the correlation coefficient\n\n**Sign:** Direction (positive/negative)\n\n**Magnitude:** Tightness around a line (near 0 = no linear pattern; near\n±1 = points nearly on a line)\n:::\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nWhat does “perfect correlation” mean visually?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nAll points lie exactly on a straight line.\n:::\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nIf correlation is -1, does that mean the variables are weakly related?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nNo. It means perfectly related but in a negative (downward) direction.\n:::\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nAs r moves from 0 toward 1, what changes visually?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nThe point cloud becomes more tightly aligned around an upward-sloping\nline.\n:::\n\n::: callout-important\n## Correlation vs. *Causation*\n In @fig-price-demand-3, we can see that as *price* increases, *sales_qty* decreases. We have said that these two variables are *correlated*. From this alone, can we infer that higher *price* **caused** lower *sales_qty*?\n \n We need to be very careful here.  @fig-price-demand-3 only shows the *correlation*. From that correlation alone we should infer anything more. Specifically, we cannot infer that the *price* changes **cause** changes in *sales*.\n \n Of course, in the real world, we know that price increases generally lead to drops in sales. But that knowledge lies outside of this data. It is quite possible that, in this situation something else might be playing a role. We just don't know from the data we are seeing. \n \n Establishing **causation** is part of *causal inference* which uses other rigorous techniques to establish that something actually caused something else. We do not go into causal inference in this course.\n\n:::\n\n## Plotting a numerical variable against a categorical one\n\nIn this course, we will only assign a numerical variable to the y-axis.\nThus, if a plot has a categorical variable, it will only occupy the\nx-axis.\n\nNumerical and categorical variables differ in how they behave in plots.\nIn @fig-advertising-sales-channel-1 we have the variable\n*advertising_spend_k* on the x-axis. Being a numerical variable, it can\npotentially take on any value on the x-axis. On the other hand, look at\n@fig-bank-account-type-balance.\n\n![Plotting a categorical variable against a numerical one -- using the\ndata frame *acct_type_balance* (not plotted using the *point_plot*\nfunction)](../../images/fig-bank-account-type-balance.png){#fig-bank-account-type-balance\nwidth=\"70%\" fig-align=\"center\"}\n\nHere we have the variable *bank_account_type* on the x-axis and it can\ntake on only one of two values *\"Checking\"* and *\"Savings\"*. This is why\neach row falls at only one of two x positions: one for *Checking*, and\none for *Savings*. So points stack vertically. If the row corresponds to\na \"Checking\" account, it falls on the left stack of points and on the\nright stack otherwise.\n\n### A Caveat\n\nCorrelation measures the strength of a *linear relationship*; a curved\npattern can have low correlation coefficient even if there is a strong\nrelationship.\n\n@fig-non-linear-strong-but-weak-corr-coeff shows a strong non-linear\n(loosely means \"not a **straight** line\") relationship. The points align\nvery close to a curved line. This has a low correlation coefficient\nbecause if you try to run a straight line through these points, no\nmatter how hard you try, you cannot draw a line that is even reasonably\nclose to all points. The correlation coefficient is -0.125 -- close to\nzero!\n\n![Strong non-linear relationship, but weak correlation\ncoefficient](../../images/fig-non-linear-strong-but-weak-corr-coeff.png){#fig-non-linear-strong-but-weak-corr-coeff\nwidth=\"70%\" fig-align=\"center\"}\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nIf *bank_account_type* has two categories, how many distinct x positions\nexist conceptually?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nTwo: one for *Checking* and one for *Savings*.\n:::\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nWhy do points form vertical “stacks” for each category?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nBecause many rows share the same category (same x position) but differ\nin balance (y).\n:::\n\n### *point_plot* and \"jittering\"\n\nIf we have two *Checking* accounts with the same or very similar\nbalance, their points will overlap. Because of this over plotting, the\nplot in @fig-bank-account-type-balance does not enable us to look at all\nthe points.\n\nTo overcome this problem, the *point_plot* function plots this chart a\nbit differently. See @fig-account-type-balance-point-plot.\n\n**Important:** Jittering changes only the display position of points to\nreduce overlap; it does not change the underlying data values\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacct_type_balance |> \n  point_plot(balance ~ bank_account_type)\n```\n\n::: {.cell-output-display}\n![Plot of account type against account bakance using the *point_plot function*: it jitters the points along the x-axis to reduce overplotting ](point-plots_files/figure-pdf/fig-account-type-balance-point-plot-1.pdf){#fig-account-type-balance-point-plot fig-pos='H'}\n:::\n:::\n\n\nTo enable us to see the points more clearly, the *point_plot* function\nrandomly \"jitters\" the points along the x-axis to more clearly separate\npoints that might be over plotted or close together.\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nWhat problem does jittering solve?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nOver plotting. Points hiding under other points.\n:::\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nDoes jittering change the data?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nNo. It only changes where points are drawn to make overlap visible.\n:::\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nIn a jittered plot, if we see two points with the same y-value and the\nsame x-category, what would have happened to them on an un-jittered\nplot??\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nThey would have overlapped and we would only have a single point\nvisible.\n:::\n\n## Bringing a third variable into the plot\n\nTwo-dimensional plots can normally accommodate only two variables -- one\non each axis. However, we can often get more insights if we manage to\nget more variables into our plots. The *point_plot* functions allows us\nto bring one more dimension to our plots through color.\n\nIn @fig-advertising-sales-channel-1, we saw the positive relationship\nbetween *weekly_sales_k* and *advertising_spend_k* in the\n*advertising_sales_channel* data frame. That data frame has another\nvariable *channel*. Each row corresponds to one of two sales channels --\n*Search Ads* and *Retail Promo*. We might want to study separately for\neach channel the relationship between advertising spend and the weekly\nsales.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nadvertising_sales_channel |> \n  point_plot(weekly_sales_k ~ advertising_spend_k + channel)\n```\n:::\n\n\n![Determining the color of points based on a third variable -- the last\nvariable in the tilde expression for the plot achieves\nthis](../../images/fig-advertising-sales-channel-color.png){#fig-advertising-sales-channel-color\nwidth=\"70%\" fig-align=\"center\"}\n\n@fig-advertising-sales-channel-color inserts, through color, the\nvariable *channel* into the plot of *weekly_sales_k* against\n*advertising_spend_k* from the *advertising_sales_channel* data frame.\nFrom it we can clearly see that the points corresponding to each sales\nchannel clearly shows the positive relationship that we saw earlier. But\nthis plot also shows that for a given value of *advertising_spend_k* the\n*Retail Promo* channel generally has a comparatively higher\n*weekly_sales_k* value. Adding the variable *channel* through color\nenabled us to see more into the data than before.\n\n### Understanding the tilde expression to add a third variable\n\n@fig-color-tilde-expression shows the tilde expression we used in a\npoint plot of two variables to color the points based on a third\nvariable.\n\n![To color the points based on the value of a third variable, we just\n*add* it to the end of the tilde-expression after a plus\nsign](../../images/fig-color-tilde-expression.png){#fig-color-tilde-expression\nwidth=\"70%\" fig-align=\"center\"}\n\n@fig-color-tilde-expression-2 shows another example. In this, we use the\n*mpg* data frame which contains data on cars. We plot the city mileage\nof cars (variable *cty*) against their engine displacement (variable\n*displ*). We color each point based on the class of the vehicle\n(variable *class*).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpg |> \n  point_plot(cty ~ displ + class)\n```\n:::\n\n\n![The scatterplot shows the relationship between *displ* and *cty* from\nthe *mpg* data frame -- the variable *class* in the tilde expression\ndetermines the color of the\npoints](../../images/fig-color-tilde-expression-2.png){#fig-color-tilde-expression-2\nwidth=\"70%\" fig-align=\"center\"}\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nIn weekly_sales_k \\~ advertising_spend_k + channel, what does channel\ncontrol?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nThe color of points.\n:::\n\n::: {.callout-note icon=\"false\"}\n## Quick Check {.unnumbered}\n\nWhat new insight can color reveal that the two-variable plot cannot?\n:::\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer {.unnumbered}\n\nDifferences in level or pattern between groups (e.g., Retail Promo tends\nto have higher sales at the same ad spend).\n:::\n\n## Bringing a fourth variable into play\n\nWe can bring a fourth variable into play as well through *facets*.\nReplacing the tilde expression above with:\n\n```         \nhwy ~ displ + class + drv\n```\n\ngenerates @fig-facet-example-1.\n\n![The scatterplot shows the relationship between *displ* and *cty* from\nthe *mpg* data frame -- the variable *class* in the tilde expression\ndetermines the color of the points and the variable *drv* divides the\nplot into\n*facets*](../../images/fig-facet-example-1.png){#fig-facet-example-1\nwidth=\"70%\" fig-align=\"center\"}\n\nIn this figure, we use the *mpg* data frame and generate a basic\nscatterplot of the relationship between the highway mileage (variable\n*hwy*) and the engine displacement (variable*displ*). The third variable\n*class* determines the color of the points. The fourth variable *drv*\nsegments the plots into *facets* -- one for each possible value of\n*drv*.\n\n::: callout-important\n**Tilde expression summary**\n\ny \\~ x → y on vertical axis, x on horizontal axis\n\ny \\~ x + color → color encodes the third variable\n\ny \\~ x + color + facet → facet splits into panels by the fourth variable\n:::\n\n## Mini-Review: Scatterplots and Relationships {.unnumbered}\n\n::: {.callout-note}\nAnswer the questions below to check your understanding of how scatterplots\nrepresent data and relationships between variables.\n:::\n\n### Question 1 {.unnumbered}\nIn a scatterplot of `sales_qty ~ price`, what does the x-coordinate of a point represent?\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer\nThe x-coordinate represents the value of `price` for that observation.\n:::\n\n---\n\n### Question 2 {.unnumbered}\nIn the same scatterplot, what does the y-coordinate of a point represent?\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer\nThe y-coordinate represents the value of `sales_qty` for that observation.\n:::\n\n---\n\n### Question 3 {.unnumbered}\nIf a scatterplot is based on a data frame with 500 rows, how many points appear in the plot?\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer\n500 points — one for each row of the data frame.\n:::\n\n---\n\n### Question 4 {.unnumbered}\nDescribe how you would locate on the plot the point corresponding to a row with  \n`price = 12.5` and `sales_qty = 1200`.\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer\nLocate 12.5 on the x-axis, move vertically until reaching 1200 on the y-axis,\nand mark the intersection.\n:::\n\n---\n\n### Question 5 {.unnumbered}\nWhat visual pattern indicates a **negative relationship** between two numerical variables?\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer\nA downward-sloping cloud of points: as x increases, y generally decreases.\n:::\n\n---\n\n### Question 6 {.unnumbered}\nWhat does it mean if a scatterplot shows **no clear trend**?\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer\nThere is no apparent linear relationship — higher or lower values of one variable\ndo not predict higher or lower values of the other.\n:::\n\n---\n\n### Question 7 {.unnumbered}\nWhat does the **sign** of the correlation coefficient tell you?\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer\nIt tells you the direction of the linear relationship:\npositive for upward trends and negative for downward trends.\n:::\n\n---\n\n### Question 8 {.unnumbered}\nA correlation coefficient close to 0 means what?\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer\nThere is little or no **linear** relationship between the variables, even though\na nonlinear relationship may still exist.\n:::\n\n---\n\n### Question 9 {.unnumbered}\nWhy does `point_plot()` jitter points when the x-axis variable is categorical?\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer\nTo reduce over plotting so that points with the same category and similar\nvalues do not overlap visually.\n:::\n\n---\n\n### Question 10 {.unnumbered}\nIn the formula  \n`weekly_sales_k ~ advertising_spend_k + channel`,  \nwhat role does `channel` play in the plot?\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer\nIt determines the color of the points, allowing different groups to be distinguished visually.\n:::\n\n---\n\n### Question 11 {.unnumbered}\nWhat additional role does a fourth variable play when added as  \n`y ~ x + color_var + z`?\n\n::: {.callout-note icon=\"false\" collapse=\"true\"}\n## Suggested answer\nIt divides the plot into separate panels (facets), one for each value of the fourth variable.\n:::\n\n",
    "supporting": [
      "point-plots_files/figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{\"knit_meta_id\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"]}},\"value\":[{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"booktabs\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"longtable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"array\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"multirow\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"wrapfig\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"float\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"colortbl\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"pdflscape\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"tabu\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttablex\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"ulem\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"normalem\"]},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"makecell\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"xcolor\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]}]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}