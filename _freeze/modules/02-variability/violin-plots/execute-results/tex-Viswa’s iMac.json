{
  "hash": "183524f6b2140ea2d2bcf3ca1863435b",
  "result": {
    "engine": "knitr",
    "markdown": "# Using Violin Plots to Visualize Distribution\n\nThis chapter talks about visualizing variability.\n\n## Learning outcomes  {.unnumbered}\n\n### After completing this chapter you will be able to:  {.unnumbered}\n\n**Demonstrate these outcomes related to shapes of distributions:**\n\n  - Given a distribution as histogram, explain what the height of a bar represents\n  - Given a distribution as a violin plot, explain what the width of a violin at any point represents\n  - Given a violin plot, identify the point(s) having the highest and lowest densities\n  - Identify whether a given distribution shown either as a histogram or as a violin plot or as a density plot is\n    - uniform\n    - symmaetric bell shaped\n    - multi-modal\n    - skewed and in which way\n\n**Demonstrate these outcomes related to generating violin plots using R:**\n\n  - Given a data frame and a numerical variable, write R code to generate a violin plot to study the distribution of the variable\n  - Explain the two important parts of the plot area in a violin plot\n  - In the plot, identify which part represents the data and whih part represents the *annotation*\n  - Explain the tilde espression used to generate violin plots of single variables\n  - Generate a violin plot to comnpare the distributions of a single numerical variable corresponding to a categorical variable\n\n\nWe have already looks at the concept of *variable*. We have used the term to refer to a column of a data frame. We  explained the rationale for the name from the fact that the values in a single column of a data frame *vary*. That is, not all the rows of a column have the same value. For example, we see in @tbl-boston-marathon-2 that the values in the column *minutes* vary -- that is, not all the values in the column are the same. The same is true of every column. \n\n\n::: {#tbl-boston-marathon-2 .cell tbl-cap='Boston Marathon data (20 randonmly selected rows).'}\n::: {.cell-output-display}\n\n\n| year|name                      |country       |time     |sex    | minutes|\n|----:|:-------------------------|:-------------|:--------|:------|-------:|\n| 1961|Eino Oksanen              |Finland       |02:23:39 |male   |     144|\n| 2013|Lelisa Desisa             |Ethiopia      |02:10:22 |male   |     130|\n| 2018|Yuki Kawauchi             |Japan         |02:15:58 |male   |     136|\n| 1957|John J. Kelley            |United States |02:20:05 |male   |     140|\n| 1998|Fatuma Roba               |Ethiopia      |02:23:21 |female |     143|\n| 1994|Cosmas Ndeti              |Kenya         |02:07:15 |male   |     127|\n| 1946|Stylianos Kyriakides      |Greece        |02:29:27 |male   |     149|\n| 1948|Gerard Cote               |Canada        |02:31:02 |male   |     151|\n| 1990|Gelindo Bordin            |Italy         |02:08:19 |male   |     128|\n| 1983|Greg A. Meyer             |United States |02:09:00 |male   |     129|\n| 1988|Ibrahim Hussein           |Kenya         |02:08:43 |male   |     129|\n| 1929|John C. Miles             |Canada        |02:33:08 |male   |     153|\n| 1914|James Duffy               |Canada        |02:25:01 |male   |     145|\n| 1937|Walter Young              |Canada        |02:33:20 |male   |     153|\n| 1945|John A. Kelley            |United States |02:30:40 |male   |     151|\n| 2000|Elijah Lagat              |Kenya         |02:09:47 |male   |     130|\n| 2011|Geoffrey Mutai            |Kenya         |02:03:02 |male   |     123|\n| 1917|William J. (Bill) Kennedy |United States |02:28:37 |male   |     149|\n| 1932|Paul de Bruyn             |Germany       |02:33:36 |male   |     154|\n| 1999|Joseph Chebet             |Kenya         |02:09:52 |male   |     130|\n\n\n:::\n:::\n\n\nTake care to note that we are not saying that every value in a column has to be distinct. Values can repeat. However we have variety in a column as long as all the values are not the same. Very rarely will you come across data frames in which all the values of a column are the same. In this case the column does not serve any useful purpose for data analysis.\n\nIn this course, we deal only with variability in numerical variables. Statistics deals with variability in categorical variables as well, but this book does not consider this in any depth.\n\n## Distribution\n\nBefore we look at the distribution of variables in a data frame, let us look at variability in sets of numbers to understand the idea of *distribution*. In this chapter we focus on visualization alone. The next chapter goes into measuring variation precisely.\n\n### Uniform distribution\n\nSuppose we have 1000 numbers with each one being an integer between 1 and 100. Some of the numbers in this data might be 45, 23, 46, 89, 1, 23, 45, 56, and so on. If each number occurs exactly 10 times -- that is we have 10 ones, 10 twos and so on up to 10 hundreds, we have what is called as the *uniform distrigution*. In a uniform distribution, each number in the range of the list occurs the same number of times. \n\n@fig-perfect-uniform-hist shows a *histogram* of a set of numbers. A *histogram* breaks up the whole range of the data points into *bins*. In our example, the numbers range from 1 to 100. A histogram might break this up into some number of *bins*. If the number of bins is 10, then the numbers between 1 and 10 will fall unto 1 bin. The numbers between 11 and 20 into the next bin and so on. In this example, the bin-width is 10 because each bin spans a range of size 10. The x-axis of the histogram shows the number values and a bar for each bin. The y axis shows how many of the numbers fall into each bin and so the pattern formed by the heights of the bars helps us to see the *distribution* of the numbers.\n\n@fig-perfect-uniform-hist shows numbers that are perfectly uniformly distributed. We have used a bin-width of 1 to have each individual integer fall into its own bin. In a *uniform distribution* every number in the overall range of the numbers occurs exactly the same number of times. \n\n![Perfect uniform distribution -- each number between 1 and 100 occurs the same number of times (10 times), as you can see from the height of the bars](../../images/fig-perfect-uniform-hist.png){#fig-perfect-uniform-hist width=70% fig-align=\"center\"}\n\nOur current example deals with integers, but in general when we have numerical variables, we will deal with numbers that also have a fractional part. Histograms work in the same way for those too, except that we cannot have one bin for each distinct value as there is potentially an inficite number of values in any range.\n\n@fig-approx-uniform-hist shows an example of a set of numbers distributed approximately uniformly. For example, Each number does not occur exactly the same number of times, but they are loosely similar. For example, the number 2 seems to appear around 13 times and the number 25 seems to occur around 18 times. In practice, uniformly distributed numbers will look more like @fig-approx-uniform-hist than @fig-perfect-uniform-hist.\n\n\n![Approximate uniform distribution -- each number between 1 and 100 occurs more or less the same number of times](../../images/fig-approx-uniform-hist.png){#fig-approx-uniform-hist width=70% fig-align=\"center\"}\n\nA numerical variable does not necessarily have to be distributed uniformly. That is each number in the range does not have to occur an equal number of times exactly or approximately. We will now look at some other commmon possibilities.\n\n\n### Bell shaped distributions\n\n@fig-normal-low-sd-hist and @fig-normal-higher-sd-hist show two *bell shaped* distributions. Both have their peaks around the middle of the range between 1 and 100. Which means that numbers closer to the middle -- or closer to 50 -- occur more frequently than those far away from 50.\n\n![Symmetric bell shaped distribution with a peak at around 50](../../images/fig-normal-low-sd-hist.png){#fig-normal-low-sd-hist width=70% fig-align=\"center\"}\n\n\n\n\n![Symmetric bell shaped distribution with a peak at around 50 and higher spread than in @fig-normal-low-sd-hist](../../images/fig-normal-higher-sd-hist.png){#fig-normal-higher-sd-hist width=70% fig-align=\"center\"}\n\n\nBoth @fig-normal-low-sd-hist and @fig-normal-higher-sd-hist show bell shaped distributions that are also symmetric. That is, the shape to the left of the peak is approximately similar to the shape on the right.\n\nSo, both of these are bell shaped and symmetric, and yet they are obviously different? Can you describe how they are different?\n\nWe see that the spread* of the numbers is quite different. In @fig-normal-low-sd-hist the numbers are more concentrated near the middle than is the case in @fig-normal-higher-sd-hist. Consequently, the peak in the first figure is higher. For example, the numbers 47 and 51 occur nearly 50 times. In @fig-normal-higher-sd-hist, the higest frequency is around 35. We call the ends of the bell shae as *tails*. We see that @fig-normal-higher-sd-hist has *fatter* tails.\n\n\nWe have seen three different possibilities for how a set of 1000 numbers in the range 1 to 100 can be distributed. Even though the averages of a set of numbers and even their range might be the same they can still be *distributed* very differently.\n\n### Multi-modal distributions\n\nIn @fig-normal-low-sd-hist and @fig-normal-higher-sd-hist we saw distributions that each had a single peak. This does not have to be the case. shows a case where we have two peaks.\n\n![Distribution with more than one peak -- multi-modal distribution](../../images/fig-bimodal-hist.png){#fig-bimodal-hist width=70% fig-align=\"center\"}\n\n\n\n### Skewed distributions\n\nThus far, we have seen distributions in which the shape has always been symmetric -- explicitly so in the bell-shaped examples, but also tru for the *uniform* examples. @fig-right-skew-hist and @fig-left-skew-hist show examples of asymmetric distributions. The first has a long *tail* on the right and is said to be *right-skewed* and the second has its *tail* on the left and is said to be *left-skewed*.\n\n![Asymmetric distribution with a right skew](../../images/fig-right-skew-hist.png){#fig-right-skew-hist width=70% fig-align=\"center\"}\n\n\n![Asymmetric distribution with a left skew](../../images/fig-left-skew-hist.png){#fig-left-skew-hist width=70% fig-align=\"center\"}\n\n\n## Violin plots\n\nNow that we have clarified the idea of a *distribution* let us look at distributions of numerical variables through *violin* plots. These plots serve the same function as the histograms we have looked at in the previous section, but we can do more. Let us start off by looking at a violin plot of the variable *minutes* from the *Boston_marathon* data frame\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBoston_marathon |> \n  point_plot(minutes ~ 1, annot = \"violin\")\n```\n\n::: {.cell-output-display}\n![Violin plot of the *minutes* variable from the *Boston_marathon* data frame](violin-plots_files/figure-pdf/fig-boston-marathon-minutes-violin-1.pdf){#fig-boston-marathon-minutes-violin fig-pos='H'}\n:::\n:::\n\n\n\nThe width of the violin at any point on the y-axis shows the relative frequency of data values close to that point. The widest part of the violin occurs at around 145 minutes. This means that the maximum concentration of winning times in the dataset is close to 145 minutes. The plot does not tell us exactly what the frequency is. The width only shows the relative frequency. Looking at where the violin is very narrow, we can say that very few runners took more than 175 minutes to complete the race. Also, relatively low number sof people took less than about 125 minutes. We can see a higher density of points around the broad regions of the violin and a low density in the narrow areas of the violin.\n\n\n\n### Elements of the plot\n\nUntil now, the plots we have generated using *point plot* have only shown the actual points. However, in @fig-boston-marathon-minutes-violin we see two distinct elements:\n\n- a jittered plot of the individual points\n- a violin-shaped solid area  -- an *annotation* encompassing the points themselves\n\nThe points represent the raw data and the violin adds an *annotation* that interprets the data in some way. Here, the interpretation is a violin plot that hels us visualize the distribution of the values.\n\n### Examining the code\n\nWe examine the code now. In the code for @fig-boston-marathon-minutes-violin, we can see two arguments for the *point_plot* function. The first argument specifies the tilde expression mapping the axes. The second specifies the type of *annotation* we want. @fig-boston-marathon-minutes-violin-code-dissect shows the code with the two arguments labeled.\n\n\n![The code to generate @fig-boston-marathon-minutes-violin passes two arguments to the *point_plot* function -- a tilde expression and an *annotation* specification](../../images/fig-boston-marathon-minutes-violin-code-dissect.png){#fig-boston-marathon-minutes-violin-code-dissect width=70% fig-align=\"center\"}\n\n\n@fig-tilde-expression-violin-boston-marathon explains the tilde expression used for the plot. Mapping of *minutes* to the y-axis conforms to what we did before. This plot deals with just a single variable -- we have no variable on the x-axis. When there is no variable on the x-axis, we conventionally that by just using \"1\" for the x-axis variable.\n\n\n![The tilde expression of @fig-boston-marathon-minutes-violin-code-dissect we place *minutes* on the y-axis and since the x-axis has no variable, we just state \"1\" ](../../images/fig-tilde-expression-violin-boston-marathon.png){#fig-tilde-expression-violin-boston-marathon width=70% fig-align=\"center\"}\n\n\n\n\n@fig-annot-violin-argument explains the second argument in generating a *violin plot*.\n\n![We specify that we want a *violin annotation* ](../../images/fig-annot-violin-argument.png){#fig-annot-violin-argument width=70% fig-align=\"center\"}\n\n\n## Violin plots and distribution shapes\n\nThe violin plot displays vertical reflectional symmmetry. We can get all the information that the plot conveys just by slicing the plot vertically down the middle and looking at either of the two chunks.\n\nWhen we first talked about the various distribution shapes like *uniform*, *symmatric bell-shaped*, and *skewed*, we used histograms to convey the ideas. We can deduce the same information from violin plots as well. In the next section, we will see a few more examples. We will discuss distribution shapes in the context of those examples.\n\n### More examples\n\nWe see a few more examples to reinforce the idea. @fig-price-violin-from-price-demand-dataframe shows a violin plot of the variable *price* from the *price_demand* data frame.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprice_demand |> \n  point_plot(price ~ 1, annot = \"violin\")\n```\n\n::: {.cell-output-display}\n![Violin plot of the *price* variable from the *price_demand* data frame](violin-plots_files/figure-pdf/fig-price-violin-from-price-demand-dataframe-1.pdf){#fig-price-violin-from-price-demand-dataframe fig-pos='H'}\n:::\n:::\n\n\nIf we look at only the left or right half of @fig-price-violin-from-price-demand-dataframe, turn it right by 90 degrees and get rid of the display of the individual points, we get @fig-sliced-rotated-violin -- a symmetric bell-shaped distribution.\n\n![Violin from @fig-price-violin-from-price-demand-dataframe split and rotated 90 degrees right to reveal the distribution in the form we had seen before](../../images/fig-sliced-rotated-violin.png){#fig-sliced-rotated-violin width=70% fig-align=\"center\"}\n\n\n@fig-violin-balance-from-acct-type-balance-df shows a violin plot of the *balance* variable from the *acct_type_balance* data frame.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacct_type_balance |> \n  point_plot(balance ~ 1, annot = \"violin\")\n```\n\n::: {.cell-output-display}\n![Violin plot of the *balance* variable from the *acct_type_balance* data frame](violin-plots_files/figure-pdf/fig-balance-violin-from-acct-type-balance-dataframe-1.pdf){#fig-balance-violin-from-acct-type-balance-dataframe fig-pos='H'}\n:::\n:::\n\n\nWe can see from @fig-price-violin-from-price-demand-dataframe that *price* is bell-spaped and unimoda,but not symmetric. It is skewed towards the lower values because the tail is at the bottom. If we slice and rotate it as before then we would say that it is skewed left.\n\nNext we look at the distribution of *advertising_spend_k* from the *advertising_sales_channel* data frame. @fig-advertising-spend-violin-from-advertising-sales-channel-dataframe shows the violin plot. From it we see that *advertising_spend_k* follows a nearly uniform distribution, but not poerfectly so. It is mildly bimodal.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nadvertising_sales_channel |> \n  point_plot(advertising_spend_k ~ 1, annot = \"violin\")\n```\n\n::: {.cell-output-display}\n![Violin plot of the *advertising_spend_k* variable from the *advertising_sales_channel* data frame](violin-plots_files/figure-pdf/fig-advertising-spend-violin-from-advertising-sales-channel-dataframe-1.pdf){#fig-advertising-spend-violin-from-advertising-sales-channel-dataframe fig-pos='H'}\n:::\n:::\n\n\n## Comparing distributions with violin plots\n\nThus far, we have examined distributions of individual variables in isloation. In statistics we often want to compare distributions. For example, in the *acct_type_balance* data frame, how does the distribution of *balance* for *Checking* accounts compare with that for *Savings* accounts? \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacct_type_balance |> \n  point_plot(balance ~ bank_account_type, annot = \"violin\")\n```\n\n::: {.cell-output-display}\n![Violin plots of the *balance* variable for different accoiunt types -- from the *price_demand* data frame](violin-plots_files/figure-pdf/fig-comparative-balance-violin-from-acct-type-balance-dataframe-1.pdf){#fig-comparative-balance-violin-from-acct-type-balance-dataframe fig-pos='H'}\n:::\n:::\n\n\nSince we want to compare the two violins corresponding to the two different account types, we now have *bank_account_type* on the x-axis and our tilde expression reflects this.\n\n@fig-comparative-balance-violin-from-acct-type-balance-dataframe shows several things: \n- account balances in *Savings* accounts are generally larger\n- account balances of *Savings* accounts are distributed in an almost symmetrical bell shape with the maximum density around $6,000. \n- account balances of *Checking* accounts are generally smaller than those of *Savings* accounts\n- account balances of *Checking* accounts are bell shaped, but skewed towards lower values with the maximum density around $5,400 or so.\n\n\n-\nAs another example of comparing distributions, let us use the *advertising_sales_channel* data frame to compare the distribution of *weekly_sales_k* for different *channel*s .\n\n\n::: {.cell}\n\n```{.r .cell-code}\nadvertising_sales_channel |> \n  point_plot(weekly_sales_k ~ channel, annot = \"violin\")\n```\n\n::: {.cell-output-display}\n![Violin plots of the *weekly_sales_k* variable for different sales channels -- from the *advertising_sales_channel* data frame](violin-plots_files/figure-pdf/fig-comparative-weekly-spend-violin-from-advertising-sales-channel-data-frame-1.pdf){#fig-comparative-weekly-spend-violin-from-advertising-sales-channel-data-frame fig-pos='H'}\n:::\n:::\n\n\n@fig-comparative-weekly-spend-violin-from-advertising-sales-channel-data-frame tells us the following:\n- *weekly_sales_k* values are generally lower for the *Retail Promo* channel\n- for the *Retail Promo* channel *weekly_sales_k* is distributed symmateically with three short peaks\n- *weekly_sales_k* values are almost uniformly distributed for the *Search Ads* channel and have a much larger range than the *Retail Sales* channel\n",
    "supporting": [
      "violin-plots_files/figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}