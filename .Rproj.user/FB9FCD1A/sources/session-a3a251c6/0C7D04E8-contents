---
title: "BQUA2811 Sample Project Report -- Fall 2025"
author: "Viswa Viswanathan"
date: "2025-11-26"
output:
  pdf_document: 
    latex_engine: pdflatex
    toc: true
    toc_depth: 3
  word_document: default
  html_document:
    df_print: paged
fontsize: 12pt
header-includes:
  - \usepackage{hyperref}
  - \usepackage{enumitem}
  - \hypersetup{pdfborder={0 0 0}, pdfhighlight=/N}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE)
library(LSTbook)
```
\newpage
## Introduction
This document presents my project report for BQUA2811.

## Dataset

I chose a dataset containing data on bank loans and loan defaults in a certain bank. I obtained the data from the UCI Machine Learning Repository (https://archive.ics.uci.edu/). The dataset meets the project requirements because it has two numeric and two categorical variables and has 10,000 rows.

I placed the data in my working directory and read it in using the following command. **Students, you can read it in by directly clicking on it in RStudio and selecting "Import dataset".**
```{r}
loan <- read.csv("loan_data.csv")
```
Here are the first few rows in the dataset.
```{r}
loan |> 
  head()
```
The dataset contains one row per borrower and has four columns:

- default: whether the borrower defaulted on the loan (categorical)
- student: whether the borrower was a student or not (categorical)
- balance: balance amount on the loan (numeric)
- income: the borrower's annual income (numeric)

## Distribution of numerical variables

```{r}
loan |> 
  point_plot(balance ~ 1, 
             annot = "violin", 
             point_ink = 0.2)
```

From the plot, I see that *balance* is almost symmetrical, with a slight skew tiwards higher values. The highest density occurs at a *balance* of around $750.

```{r}
loan |> 
  point_plot(income ~ 1, 
             annot = "violin", 
             point_ink = 0.2)
```

From the plot, I see that *income* has a bimodal distribution (two peaks), with the peaks occurring at around $18,000 and $38,000.

## Plots

This section contains the required plots.

### Numerical response and numerical explanatory

I used the following code to generate the plot of the effect of *income* on *balance*.

```{r}
loan |> 
  point_plot(balance ~ income, 
             annot = "model", point_ink = 0.2)
```

Income and balance are negatively related, but weakly, since I see that the points are very widely scattered around the model. I can trust the model because I see that a horizontal line will not fit in the band.

### Numerical response with categorical explanatory

I used the following code to generate the plot of the effect of *student* on *balance*. I used a very small point_ink value and a high model_ink value because the points were crowding out the model.

```{r}
loan |> 
  point_plot(balance ~ student, 
             annot = "model", point_ink = 0.01,
             model_ink = 1)
```

From the plot, I can see that  *balance* for *students* is generally higher than that for non_students. I can trust the model since I cannot draw a horizontal line that cuts through both bands.

I used the following code to generate the plot of the effect of *default* on *balance*.

```{r}
loan |> 
  point_plot(balance ~ default, 
             annot = "model", 
             point_ink = 0.01, 
             model_ink = 1)
```

From the plot, I can see that *balance* for *defaulters* is generally much higher than that for non_defaulters. I can trust the model since I cannot draw a horizontal line that cuts through both bands.

### Numerical response with one numerical and one categorical explanatory

(I have show two, but one will suffice)

I used the following code to build a model with *balance* as the response variable and *income* and *student* as explanatory variables.

```{r}
loan |> 
  point_plot(balance ~ income + student, 
             annot = "model", 
             point_ink = 0.01, 
             model_ink = 1)
```

As I expected, I see that the balance for students is generaly higher. For both students and non-students, I see a weak negative relationship between *balance* and *income*. In fact independently these two relationships cannot be trusted.


I used the following code to build a model with *balance* as the response variable and *income* and *default* as explanatory variables.

```{r}
loan |> 
  point_plot(balance ~ income + default, 
             annot = "model", 
             point_ink = 0.01, 
             model_ink = 1)
```

As expected, I see that the balance for defaulters is generaly higher. For both defaulters and non-defaulters, I see a reasonably strong negative relationship between *balance* and *income*. 

## Variance analysis

### Numerical response with numerical explanatory

I used the following code to build a model with *balance* as the outcome or response variable and *income* as the explanatory variable and generate the variance of the response variable, the variance of the model values and the variance of the residuals. I also computed the percent of variance that the model explains.

```{r}
loan |> 
  mutate(modval = model_values(balance ~ income),
         resid = balance - modval) |>
  summarize(tot_var = var(balance),
            mod_var = var(modval),
            resid_var = var(resid),
            perc_explained = mod_var/tot_var * 100)
```

We see that the model explains only 2.3% of the variation. As we saw earlier, we have a very weak model that has low explanatory power.

### Numerical response with numerical and categorical explanatory

I used the following code to build a model with *balance* as the outcome or response variable and *income* and *student* as the explanatory variables and to generate the variance of the response variable, the variance of the model values and the variance of the residuals. I also computed the percent of variance that the model explains.

```{r}
loan |> 
  mutate(modval = model_values(balance ~ income + student),
         resid = balance - modval) |>
  summarize(tot_var = var(balance),
            mod_var = var(modval),
            resid_var = var(resid),
            perc_explained = mod_var/tot_var * 100)
```

We see that the model explains only 4.1% of the variation.

We can also directly compute the proportion of total variability that the model explains (R-squared) by using the R2 function. I show the code for that below.

```{r}
loan |> 
  model_train(balance ~ income) |> 
  R2()
```

```{r}
loan |> 
  model_train(balance ~ income + student) |> 
  R2()
```

Looking at the column R-Squared, as expected, we get the same results as when we calculated the variances and computed the R-squared by ourselves.

## Conclusion

(Write your own conclusion summarizing the experience of completing the project.)