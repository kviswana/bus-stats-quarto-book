<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>path-to-models-story</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="path-to-models-story_files/libs/clipboard/clipboard.min.js"></script>
<script src="path-to-models-story_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="path-to-models-story_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="path-to-models-story_files/libs/quarto-html/popper.min.js"></script>
<script src="path-to-models-story_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="path-to-models-story_files/libs/quarto-html/anchor.min.js"></script>
<link href="path-to-models-story_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="path-to-models-story_files/libs/quarto-html/quarto-syntax-highlighting-985aa47af68dae11cd4d235c71fb941e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="path-to-models-story_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="path-to-models-story_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="path-to-models-story_files/libs/bootstrap/bootstrap-81267100e462c21b3d6c0d5bf76a3417.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<section id="sec-mean-model" class="level1">
<h1>The Simplest Model</h1>
<p>This chapter helps you to dip your toes into the vast and important topic of models.</p>
<section id="learning-outcomes" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="learning-outcomes">Learning outcomes</h2>
<section id="after-completing-this-chapter-you-will-be-able-to" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="after-completing-this-chapter-you-will-be-able-to">After completing this chapter you will be able to:</h3>
<ul>
<li>Explain the term model from a general perspective, and from the perspective of statistics</li>
<li>Explain why, given the values of only one variable and in the absence of any other information, the mean is the best model</li>
<li>Explain in what sense the mean is the <em>best</em> model</li>
<li>Given a model equation, identify the <em>outcome</em> variable and the <em>explanatory</em> variable(s)</li>
<li>Describe the terms <em>outcome</em> variable and **explanatory* variable</li>
<li>Match the terminology between the two pairs (<em>outcome</em> variable, <em>explanatory</em> variable) and (independent variable, <em>dependent</em> variable)</li>
<li>Given a model with a single numerical <em>explanatory</em> variable and a value for the <em>explanatory</em> variable, compute the model value.</li>
<li>Explain why we place a <em>hat</em> on the <em>outcome</em> variable in a model expression</li>
<li>Explain why we call a model’s output an <em>estimate</em></li>
<li>List and describe the two uses of models covered in this chapter</li>
</ul>
</section>
</section>
<section id="companies-commit-when-they-make-decisions" class="level2">
<h2 class="anchored" data-anchor-id="companies-commit-when-they-make-decisions">Companies <em>commit</em> when they make decisions</h2>
<p>Good decision-making lies at the heart of effective business management.</p>
<p>In practice, companies must commit to decisions before they know how it will play out in the real-world. Many important business decisions cannot be revised freely once they are made. Examples include setting prices, determining how much inventory to stock, choosing staffing levels, or deciding where to locate a factory.</p>
<p>Once a decision is made, it influences many individual events that unfold over time.</p>
<p>Consider pricing. A company sets a single price for a product, and then thousands of customers independently decide whether or not to buy at that price. One decision by the firm affects many separate outcomes.</p>
<p>This has an important implication: <em>we cannot judge the quality of a decision based on a single outcome</em>.</p>
<p>Suppose a company sets a price of $10 and the first customer who walks in buys the product. Was $10 the right price? We cannot really say. That single outcome may simply be good luck. If we observe the decisions of 1,000 customers, however, a clearer picture begins to emerge. Over many independent events, good decisions tend to perform well <em>on average</em>.</p>
<p>In business, then, decisions must be made in advance, under uncertainty, and their quality must be judged by how well they balance out across many realizations and not by whether they happen to succeed in one particular instance.</p>
<p>This perspective will guide how we think about models in this chapter. A good model is not one that gets lucky once. It is one that performs reliably across many possible outcomes.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition of model for our present purposes
</div>
</div>
<div class="callout-body-container callout-body">
<p>A model is a simple rule or equation that uses data to produce predictions or explanations, while deliberately ignoring some details of reality.</p>
</div>
</div>
</section>
<section id="sec-mean-game" class="level2">
<h2 class="anchored" data-anchor-id="sec-mean-game">Staffing kiosks with incomplete data: Deciding under uncertainty</h2>
<p>Amanda, the owner of <em>Random Treats</em> walks into a conference room with a small group of business school interns.</p>
<p>“I run two small sales kiosks,” she says. “One at the <em>Beach</em>. One at the <em>Mall</em>. I need to set staffing levels for the next month.”</p>
<p>Amanda holds up a messy spreadsheet printout.</p>
<p>“Customer counts from the last 20 days,” she says. “But the person who collected the data forgot to record <em>which kiosk</em> each number came from. My problem is that I have to set the staffing level for the next month at my kiosks and I have to base that on the expected number of customers who will show up at the kiosks.”</p>
<p>Someone laughs nervously. Amanda does not.</p>
<p>“I don’t have time to redo data collection,” she says. “So we work with what we have. But first, I want to see how you think.</p>
<p>Based on the data we have, I want to settle on a single number for how many customers will show up at the kiosks each day. I will use that number to set the staffing level for the kiosks – same for both kiosks.”</p>
<p>She grabs a marker.</p>
<p>“Here’s a tiny practice version of the problem, with small numbers that you can wrap your head around. Instead of the messy numbers on the spreadhseet, assume that these small numbers were the number of customers who showed up over the past several days at a kiosk (beach or mall). Now tell me what single number I should use as the representative demand at a kiosk?”</p>
<p>She writes the following set of 10 numbers on the board:</p>
<p>4, 5, 7, 1, 8, 4, 3, 9, 5, 4</p>
<p>You should think of this set as representing possible outcomes—number of customers who show up at a kiosk. I am keeping the numbers small so that we can first arrive at a method. We can then apply the chosen method to the messy real-world numbers. You do not know which value will actually occur on any given day, but you have reason to believe that the overall pattern will be similar to these numbers.”</p>
<p>Angela asks “But why should you keep the same number each day? Can we not adjust staffing day by day?”</p>
<p>Amanda says “Good thinking, Angela. I would love to be efficient, but I cannot do that. Firstly, I want to give some stability to the staff so that they can rest asusred that they have guaranteed employment for the whole month. Secondly, I run many businesses and I can only commit a few hours to this business. So today is the day I make the staffing decision for the next month for this business. I can revisit this decision only next month.”</p>
<p>“Got it” says Angela.</p>
<p>Amanda … “OK, guys, put on your thinking hats.”.</p>
<p>“Here are the rules of the game:</p>
<ol type="1">
<li><p>You as a team commit to a single number for expected sales on any given day at either kiosk. This is your guess, and you must choose it before any outcomes – actual sales – are revealed over the month. You can assume that the pattern will be similar to the data I have given you.</p></li>
<li><p>I then pretend to be the real-world, and determine the first day’s demand by randomly select one number (customer demand) from our set. This number I pick might be the same as, lower than, or higher than your committed number. The closer it is to the number I pick randomly, the better. I will compute the difference between the numbers.</p></li>
<li><p>Now comes the twist. I square the difference to obtain the <em>penalty</em> for that round.</p></li>
<li><p>We repeat steps 2 and 3, twenty times just to get a reasonable number of trials, and add up all the <em>penalties</em>.</p></li>
</ol>
<p>The result of step 4 is your <em>total penalty</em>.</p>
<p>Obviously, your goal is to keep this total penalty as small as possible to keep the number you committed to close to the actual number of customers (the numbers I picked randomly) .</p>
<p>So, remember, you commit once and the real world plays out day after day. AT the end of 20 days, we want to see the overall penalty. It is no good doing really well on a few days and being way off on others. Consistency is key.”</p>
<p>Steve seemed perplexed. “But Amanda, why not just add the differences? Why square them and then add?”</p>
<p>“I like that Steve. You are thinking well about this already” said Amanda. In our business we can afford small deviations from reality, but the father our decisions are from reality, we pay a far heftier price. So I want to really avoid large deviations from reality and squaring the difference does that well.”</p>
<p>“Oh, I get it. We did something similar when we calculated variances in our statistics class.”</p>
<p>Amanda: “Nice connection Steve!”</p>
<p>“OK team. Why don’t you guys discuss for 10 minutes and give me a number while I grab a coffee?”</p>
<p>10 minutes later: “Amanda, we have discussed and picked 5” says Dave.</p>
<p>“Thanks, Dave. I will now generate the number of customers for 20 days and we can compute the total penalty.”</p>
<div id="tbl-decision-penalty-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-quarto-postprocess="true" style="border-collapse:collapse;">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-decision-penalty-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Decision, random choices, and resulting penalties
</figcaption>
<div aria-describedby="tbl-decision-penalty-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-decision-penalty-1" class="caption-top table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th colspan="2" style="text-align: right; padding: 2px 6px; font-weight: 600;">Decision =</th>
<th style="text-align: right; padding: 2px 6px;">5</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th" style="text-align: right; padding: 2px 6px;">random_choice</th>
<th data-quarto-table-cell-role="th" style="text-align: right; padding: 2px 6px;">diff</th>
<th data-quarto-table-cell-role="th" style="text-align: right; padding: 2px 6px;">penalty</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">7</td>
<td style="text-align: right; padding: 2px 6px;">-2</td>
<td style="text-align: right; padding: 2px 6px;">4</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">4</td>
<td style="text-align: right; padding: 2px 6px;">16</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">4</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">4</td>
<td style="text-align: right; padding: 2px 6px;">16</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">7</td>
<td style="text-align: right; padding: 2px 6px;">-2</td>
<td style="text-align: right; padding: 2px 6px;">4</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">3</td>
<td style="text-align: right; padding: 2px 6px;">2</td>
<td style="text-align: right; padding: 2px 6px;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">3</td>
<td style="text-align: right; padding: 2px 6px;">2</td>
<td style="text-align: right; padding: 2px 6px;">4</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">5</td>
<td style="text-align: right; padding: 2px 6px;">0</td>
<td style="text-align: right; padding: 2px 6px;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">4</td>
<td style="text-align: right; padding: 2px 6px;">16</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">4</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">6</td>
<td style="text-align: right; padding: 2px 6px;">-1</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">4</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">6</td>
<td style="text-align: right; padding: 2px 6px;">-1</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">4</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">3</td>
<td style="text-align: right; padding: 2px 6px;">2</td>
<td style="text-align: right; padding: 2px 6px;">4</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">4</td>
<td style="text-align: right; padding: 2px 6px;">16</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">3</td>
<td style="text-align: right; padding: 2px 6px;">2</td>
<td style="text-align: right; padding: 2px 6px;">4</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">4</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">4</td>
<td style="text-align: right; padding: 2px 6px;">16</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">4</td>
<td style="text-align: right; padding: 2px 6px;">16</td>
</tr>
<tr class="odd">
<td colspan="2" style="text-align: right; padding: 2px 6px; font-weight: 600;">Total penalty =</td>
<td style="text-align: right; padding: 2px 6px; font-weight: 600;">127</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Amanda: “Can you reduce the penalty?”</p>
<p>Paul: “Let’s try 7.”</p>
<div id="tbl-decision-penalty-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-quarto-postprocess="true" style="border-collapse:collapse;">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-decision-penalty-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Decision, random choices, and resulting penalties (Decision = 7)
</figcaption>
<div aria-describedby="tbl-decision-penalty-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-decision-penalty-2" class="caption-top table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th colspan="2" style="text-align: right; padding: 2px 6px; font-weight: 600;">Decision =</th>
<th style="text-align: right; padding: 2px 6px;">7</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th" style="text-align: right; padding: 2px 6px;">random_choice</th>
<th data-quarto-table-cell-role="th" style="text-align: right; padding: 2px 6px;">diff</th>
<th data-quarto-table-cell-role="th" style="text-align: right; padding: 2px 6px;">penalty</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">6</td>
<td style="text-align: right; padding: 2px 6px;">36</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">7</td>
<td style="text-align: right; padding: 2px 6px;">0</td>
<td style="text-align: right; padding: 2px 6px;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">6</td>
<td style="text-align: right; padding: 2px 6px;">36</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">3</td>
<td style="text-align: right; padding: 2px 6px;">4</td>
<td style="text-align: right; padding: 2px 6px;">16</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">2</td>
<td style="text-align: right; padding: 2px 6px;">5</td>
<td style="text-align: right; padding: 2px 6px;">25</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">2</td>
<td style="text-align: right; padding: 2px 6px;">5</td>
<td style="text-align: right; padding: 2px 6px;">25</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">2</td>
<td style="text-align: right; padding: 2px 6px;">5</td>
<td style="text-align: right; padding: 2px 6px;">25</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">6</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">5</td>
<td style="text-align: right; padding: 2px 6px;">2</td>
<td style="text-align: right; padding: 2px 6px;">4</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">3</td>
<td style="text-align: right; padding: 2px 6px;">4</td>
<td style="text-align: right; padding: 2px 6px;">16</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">4</td>
<td style="text-align: right; padding: 2px 6px;">3</td>
<td style="text-align: right; padding: 2px 6px;">9</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">2</td>
<td style="text-align: right; padding: 2px 6px;">5</td>
<td style="text-align: right; padding: 2px 6px;">25</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">6</td>
<td style="text-align: right; padding: 2px 6px;">36</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">2</td>
<td style="text-align: right; padding: 2px 6px;">5</td>
<td style="text-align: right; padding: 2px 6px;">25</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">2</td>
<td style="text-align: right; padding: 2px 6px;">5</td>
<td style="text-align: right; padding: 2px 6px;">25</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">2</td>
<td style="text-align: right; padding: 2px 6px;">5</td>
<td style="text-align: right; padding: 2px 6px;">25</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">4</td>
<td style="text-align: right; padding: 2px 6px;">3</td>
<td style="text-align: right; padding: 2px 6px;">9</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">4</td>
<td style="text-align: right; padding: 2px 6px;">3</td>
<td style="text-align: right; padding: 2px 6px;">9</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">6</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">5</td>
<td style="text-align: right; padding: 2px 6px;">2</td>
<td style="text-align: right; padding: 2px 6px;">4</td>
</tr>
<tr class="odd">
<td colspan="2" style="text-align: right; padding: 2px 6px; font-weight: 600;">Total penalty =</td>
<td style="text-align: right; padding: 2px 6px; font-weight: 600;">352</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>The entire room erupted in a big “Oh no Paul” and he hid his face in embarassment as his choice had balooned the penalty.</p>
<p>Amanda: “Any thoghts?” David: “We went higher than 5 and it increased the penalty. Perhaps we should try going lower to see if reduces the penalty or increases it. We can go based on that outcome. How about we try 2?”</p>
<p>Amamda: “OK, here we go.”</p>
<div id="tbl-decision-penalty-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-quarto-postprocess="true" style="border-collapse:collapse;">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-decision-penalty-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Decision, random choices, and resulting penalties (Decision = 2)
</figcaption>
<div aria-describedby="tbl-decision-penalty-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-decision-penalty-3" class="caption-top table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th colspan="2" style="text-align: right; padding: 2px 6px; font-weight: 600;">Decision =</th>
<th style="text-align: right; padding: 2px 6px;">2</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th" style="text-align: right; padding: 2px 6px;">random_choice</th>
<th data-quarto-table-cell-role="th" style="text-align: right; padding: 2px 6px;">diff</th>
<th data-quarto-table-cell-role="th" style="text-align: right; padding: 2px 6px;">penalty</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">7</td>
<td style="text-align: right; padding: 2px 6px;">-5</td>
<td style="text-align: right; padding: 2px 6px;">25</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">6</td>
<td style="text-align: right; padding: 2px 6px;">-4</td>
<td style="text-align: right; padding: 2px 6px;">16</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">2</td>
<td style="text-align: right; padding: 2px 6px;">0</td>
<td style="text-align: right; padding: 2px 6px;">0</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">2</td>
<td style="text-align: right; padding: 2px 6px;">0</td>
<td style="text-align: right; padding: 2px 6px;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">4</td>
<td style="text-align: right; padding: 2px 6px;">-2</td>
<td style="text-align: right; padding: 2px 6px;">4</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">2</td>
<td style="text-align: right; padding: 2px 6px;">0</td>
<td style="text-align: right; padding: 2px 6px;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">2</td>
<td style="text-align: right; padding: 2px 6px;">0</td>
<td style="text-align: right; padding: 2px 6px;">0</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">3</td>
<td style="text-align: right; padding: 2px 6px;">-1</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">4</td>
<td style="text-align: right; padding: 2px 6px;">-2</td>
<td style="text-align: right; padding: 2px 6px;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">3</td>
<td style="text-align: right; padding: 2px 6px;">-1</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">6</td>
<td style="text-align: right; padding: 2px 6px;">-4</td>
<td style="text-align: right; padding: 2px 6px;">16</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">2</td>
<td style="text-align: right; padding: 2px 6px;">0</td>
<td style="text-align: right; padding: 2px 6px;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">2</td>
<td style="text-align: right; padding: 2px 6px;">0</td>
<td style="text-align: right; padding: 2px 6px;">0</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">3</td>
<td style="text-align: right; padding: 2px 6px;">-1</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">4</td>
<td style="text-align: right; padding: 2px 6px;">-2</td>
<td style="text-align: right; padding: 2px 6px;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right; padding: 2px 6px;">7</td>
<td style="text-align: right; padding: 2px 6px;">-5</td>
<td style="text-align: right; padding: 2px 6px;">25</td>
</tr>
<tr class="even">
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
<td style="text-align: right; padding: 2px 6px;">1</td>
</tr>
<tr class="odd">
<td colspan="2" style="text-align: right; padding: 2px 6px; font-weight: 600;">Total penalty =</td>
<td style="text-align: right; padding: 2px 6px; font-weight: 600;">101</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Of the four, plays, the third play had the lowest total penalty and emerged as the best.</p>
<p>However, can we do even better? What approach will help us to reduce this total difference or error?</p>
</section>
<section id="average-or-mean-as-the-decision-in-the-long-run" class="level2">
<h2 class="anchored" data-anchor-id="average-or-mean-as-the-decision-in-the-long-run">Average or <em>mean</em> as the decision in the long run</h2>
<p>It turns out that when we have a large number of tries, we will get the best results, that is the lowest penalty, when we always guess the average of the numbers. In this case the average is 3.5. Here are the results of one trial.</p>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td style="text-align: left;">decision =</td>
<td style="text-align: right;">3.5</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: right;">random_choice</th>
<th style="text-align: right;">diff</th>
<th style="text-align: right;">penalty</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">2.25</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">-1.5</td>
<td style="text-align: right;">2.25</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">-0.5</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">2.25</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">-3.5</td>
<td style="text-align: right;">12.25</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">6.25</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">-1.5</td>
<td style="text-align: right;">2.25</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">-0.5</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">-2.5</td>
<td style="text-align: right;">6.25</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">2.25</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">-0.5</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">6.25</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">-1.5</td>
<td style="text-align: right;">2.25</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">-3.5</td>
<td style="text-align: right;">12.25</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">-0.5</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.25</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td style="text-align: left;">Total penalty =</td>
<td style="text-align: right;">59</td>
</tr>
</tbody>
</table>
<p>We can see that the total penalty is smaller than for any of the others.</p>
<p>SO, we see that in the absence of any other information to help us predict, the best prediction is the <em>mean</em>. <a href="#fig-many-nos-one-pred" class="quarto-xref">Figure&nbsp;1</a> shows this pictorially.</p>
<div id="fig-many-nos-one-pred" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-many-nos-one-pred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../../images/fig-many-nos-one-pred.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-many-nos-one-pred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Many numbers, but just a single prediction!
</figcaption>
</figure>
</div>
<p>What we have said above <strong>does not mean that we are guaranteed to get the smallest total error if we commit to the average</strong>. Clearly, if someone were lucky enough that the random picks all ended up exactly equal to or very close to their decision just by chance, then their total error will be zero! But this is <em>extremely unlikely</em>.</p>
<p>However, those occurrences are extraordinarily unlikely with a large number of trials, as happens in business where a decision is tested by thousands of events. <em>Statistically</em> the best course would be to pick the average.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Quick Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>In what sense is the mean the “best” model?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Suggested answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>“Best” means minimizing overall prediction error, not being perfect.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Quick Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Can a model be “best” and still be inaccurate?</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Suggested answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Yes. A model can be the best available option given limited information and still perform poorly in absolute terms.</p>
</div>
</div>
</div>
<p>If we repeat this game a very large number of times with different choices for <em>decision</em>, we will get a <em>total penalty</em> each time.</p>
<p><a href="#fig-mean-model-simulation-plot" class="quarto-xref">Figure&nbsp;2</a> shows the result of 10,000 plays of the game.</p>
<div id="fig-mean-model-simulation-plot" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mean-model-simulation-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../../images/fig-mean-model-simulation-plot.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mean-model-simulation-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Average of <em>total_penalty</em> vs various values for <em>decision</em> based on 10,000 plays of the game – shows that the lowest total penalty overall occurs when <em>decision</em> equals the mean of the numbers
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Interpret the word “best model” with caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>When we say the mean is the best model, we do not mean it is always accurate, fair, or appropriate. We mean it is best according to a specific criterion, under specific information constraints.</p>
</div>
</div>
<p>Now you know why I titled the chapter <em>The simplest Model</em>!</p>
</section>
<section id="real-world-connection-planning-for-customer-demand" class="level2">
<h2 class="anchored" data-anchor-id="real-world-connection-planning-for-customer-demand">Real world connection: Planning for Customer Demand</h2>
<p>How does this small “practice game” relate to the real world? Let us return to the manager’s kiosk problem.</p>
<p>A company operates two small sales kiosks in the same city—one at the <em>Beach</em> and one at the <em>Mall</em>. The company must decide how many workers to schedule each day.</p>
<section id="what-the-company-must-do" class="level3">
<h3 class="anchored" data-anchor-id="what-the-company-must-do">What the company must do</h3>
<ul>
<li>The staffing decision must be made <strong>in advance</strong></li>
<li>Once the schedule is set, it cannot be easily changed without disrupting employees</li>
<li>In this first round, the manager insists on <strong>one number</strong> to use everywhere (the same staffing plan for both kiosks)</li>
</ul>
</section>
<section id="what-the-company-knows" class="level3">
<h3 class="anchored" data-anchor-id="what-the-company-knows">What the company knows</h3>
<ul>
<li>The company has historical data on daily customer counts—but in an unhelpful format</li>
<li>The counts are <strong>not labeled by kiosk</strong> (Beach vs Mall)</li>
<li>At this point, the company does not have any data to explain <em>why</em> customer traffic changes. It simply observes that demand varies</li>
</ul>
<p>Here are the 20 historical customer counts (mixed together, with no kiosk identification):</p>
<pre><code>89, 95, 131, 101, 103, 134, 109, 75, 86, 91, 177, 151, 152, 143, 123, 194, 155, 81, 161, 126</code></pre>
</section>
<section id="why-the-decision-matters" class="level3">
<h3 class="anchored" data-anchor-id="why-the-decision-matters">Why the decision matters</h3>
<ul>
<li><p>If too few workers are scheduled:</p>
<ul>
<li>customers wait longer</li>
<li>service quality suffers</li>
<li>some customers leave without buying</li>
</ul></li>
<li><p>If too many workers are scheduled:</p>
<ul>
<li>workers are idle</li>
<li>labor cost rises</li>
<li>managers waste attention adjusting schedules</li>
</ul></li>
</ul>
</section>
<section id="how-the-company-measures-mistakes" class="level3">
<h3 class="anchored" data-anchor-id="how-the-company-measures-mistakes">How the company measures mistakes</h3>
<ul>
<li><p>Being slightly wrong is not very costly</p></li>
<li><p>Being very wrong is much more costly</p></li>
<li><p>The manager therefore measures the cost of a decision as:</p>
<ul>
<li>the <strong>square of the difference</strong> between planned customers and actual customers</li>
</ul></li>
</ul>
</section>
<section id="how-the-decision-is-evaluated" class="level3">
<h3 class="anchored" data-anchor-id="how-the-decision-is-evaluated">How the decision is evaluated</h3>
<ul>
<li>The decision is <strong>not judged by a single day</strong></li>
<li>A decision that works well once may simply be lucky</li>
<li>Instead, the manager looks at performance <strong>across many days</strong></li>
<li>Daily customer counts vary, but the staffing decision stays the same</li>
</ul>
</section>
<section id="the-conclusion" class="level3">
<h3 class="anchored" data-anchor-id="the-conclusion">The conclusion</h3>
<ul>
<li>The manager must choose a single number to plan for</li>
<li>Under a squared-penalty rule, the number that minimizes total long-run cost is the <strong>average</strong> of past customer counts (here, about <strong>123.8</strong>)</li>
<li>Choosing a smaller number leads to frequent large shortages</li>
<li>Choosing a larger number leads to frequent over-staffing</li>
<li>The average balances these errors over time</li>
</ul>
</section>
<section id="why-this-matters" class="level3">
<h3 class="anchored" data-anchor-id="why-this-matters">Why this matters</h3>
<ul>
<li>This is the first “model” you learn in this book: a model that predicts the same value every time</li>
<li>It is simple, but it is not arbitrary—it is the <strong>best</strong> choice given the information available</li>
<li>Later chapters improve on this model by adding explanatory information (first categories, then numerical predictors)</li>
</ul>
</section>
</section>
<section id="optional-enrichment-topic-how-does-skew-affect-the-situation" class="level2">
<h2 class="anchored" data-anchor-id="optional-enrichment-topic-how-does-skew-affect-the-situation">Optional enrichment topic: How does skew affect the situation?</h2>
<p>In our practice game, we used the numbers:</p>
<pre><code>4, 5, 7, 1, 8, 4, 3, 9, 5, 4 </code></pre>
<p>in our game. That set has numbers across the entire range. Is it the case that the average performed well because of this? Could it be that the average will not perform well if most of the numbers fall within in a small range and a few extreme cases tend to push the average up?</p>
<p>For, example, let us take the following set of numbers:</p>
<pre><code>2, 1, 2, 1, 3, 3, 2, 1, 10, 9</code></pre>
<p>The mean is 3.4 – almost the same as the previous list of numbers we had used. However, this set has eight of its numbers less than or equal to 3. Perhaps a decision below the average will work better?</p>
<p>Let us play the game 10,000 times and see which decision performs best.</p>
<p><a href="#fig-simulation-game-summary-skewed" class="quarto-xref">Figure&nbsp;3</a> shows the results. We see that the mean is still the best <em>decision</em>.</p>
<div id="fig-simulation-game-summary-skewed" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-simulation-game-summary-skewed-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../../images/fig-simulation-game-summary-skewed.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-simulation-game-summary-skewed-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Average of <em>total_penalty</em> vs various values for <em>decision</em> based on 10,000 plays of the game – shows that the lowest total penalty overall occurs when <em>decision</em> equals the mean of the numbers
</figcaption>
</figure>
</div>
<p>Why does this happen? Choosing the average definitely leads to small penalty increases most of the time. However, if we went below the average, the relatively rare cases in which the random choice is high, it incurs a very large penalty and that offsets any benefits of going below the average, because we square the difference and that amplifies the error.</p>
<p><strong>What if we did not square the error and instead treated the absolute difference as the penalty. In this case, the <em>median</em> is the best choice.</strong> Pretty cool result if you as me! We will not go further into that topic, but it has its applications. In most practical applications, we use the squared-difference as the penalty.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pause &amp; Think
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>If two data sets have the same mean, could the mean be a better model for one than the other?</li>
<li>What additional information might help you judge if it will work better for one than for the other?</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Suggested answers
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Yes. The mean works better when observations are tightly clustered.</li>
<li>Variability, spread, or deviation from the mean would help evaluate model quality.</li>
</ol>
</div>
</div>
</div>
</section>
<section id="optional-enrichment-topic-removing-outliers-in-skewed-distributions" class="level2">
<h2 class="anchored" data-anchor-id="optional-enrichment-topic-removing-outliers-in-skewed-distributions">Optional enrichment topic: Removing outliers in skewed distributions</h2>
<p>Continuing from the prior discussion, when faced with a skewed distribution we have a peculiar situation where our intuition tells us to make a decision where most points lie, but cold computation tells us otherwise.</p>
<p>One may feel that it makes no sense to choose the mean and accumulate a slightly higher penalty in every event just to balance out the huge penalties that come rarely. But that is what makes sense when we use the quadratic penalty function.</p>
<p>If the penalty is quadratic, but we still want to not decide on the average, then we can eliminate the extreme points and reduce the skew. Then we can use the average as before. From a practical viewpoint what that would mean is that we take steps to avoid extreme events by some means.</p>
<p>Can you think of an experiment to compare removing outliers and not removing them in the context of skewed distributions to see if using the mean in both cases reduces the total penalty significantly?</p>
<p>You can delve deeper into this topic if you are interested.</p>
<ul>
<li></li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>