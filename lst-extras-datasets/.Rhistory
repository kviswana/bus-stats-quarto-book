set.seed(42)  # so you get the same “Mall” numbers each time
# 1) Choose where the two lines should intersect (a mid-range temperature works well)
pivot_temp <- median(kiosk_beach$temperature)
# 2) Control how much smaller the Mall slope is (bigger = more separation at high temps)
beta <- 0.9
# 3) Create 25 new "Mall" rows: same day + same temperature, new customers
kiosk_mall <- kiosk_beach %>%
transmute(
day = day,
kiosk = "Mall",
temperature = temperature,
customers = round(
customers - beta * (temperature - pivot_temp) + rnorm(n(), mean = 0, sd = 3)
#            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
# Adds customers when temperature < pivot, subtracts when temperature > pivot
# -> lines intersect near pivot and Mall has a smaller slope
)
) %>%
mutate(customers = pmax(customers, 0))  # guard against any negative (unlikely)
# 4) Bind Beach + Mall into one dataset (50 rows)
kiosk_beach_mall <- bind_rows(kiosk_beach, kiosk_mall)
# Optional quick check: slopes + intersection behavior
kiosk_beach_mall %>%
group_by(kiosk) %>%
summarise(slope = coef(lm(customers ~ temperature))[2], .groups = "drop")
kiosk_beach_mall |>
point_plot(customers ~ gtemperature + kiosk,
annot = "model")
kiosk_beach_mall |>
point_plot(customers ~ temperature + kiosk,
annot = "model")
kiosk_beach_mall |>
point_plot(customers ~ temperature + kiosk,
annot = "model", interval = "none")
kiosk_beach_mall |>
point_plot(customers ~ temperature + kiosk,
annot = "model")
kiosk_beach |>
point_plot(customers ~ temperature, annot = "model")
kiosk_beach <- read_csv("kiosk_beach.csv")
set.seed(42)  # so you get the same “Mall” numbers each time
# 1) Choose where the two lines should intersect (a mid-range temperature works well)
pivot_temp <- median(kiosk_beach$temperature)
# 2) Control how much smaller the Mall slope is (bigger = more separation at high temps)
beta <- 0.6
# 3) Create 25 new "Mall" rows: same day + same temperature, new customers
kiosk_mall <- kiosk_beach %>%
transmute(
day = day,
kiosk = "Mall",
temperature = temperature,
customers = round(
customers - beta * (temperature - pivot_temp) + rnorm(n(), mean = 0, sd = 3)
#            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
# Adds customers when temperature < pivot, subtracts when temperature > pivot
# -> lines intersect near pivot and Mall has a smaller slope
)
) %>%
mutate(customers = pmax(customers, 0))  # guard against any negative (unlikely)
# 4) Bind Beach + Mall into one dataset (50 rows)
kiosk_beach_mall <- bind_rows(kiosk_beach, kiosk_mall)
# Optional quick check: slopes + intersection behavior
kiosk_beach_mall %>%
group_by(kiosk) %>%
summarise(slope = coef(lm(customers ~ temperature))[2], .groups = "drop")
kiosk_beach_mall |>
point_plot(customers ~ temperature + kiosk,
annot = "model", interval = "none")
View(kiosk_beach_mall)
library(dplyr)
kiosk_beach <- read_csv("kiosk_beach.csv")
set.seed(42)  # so you get the same “Mall” numbers each time
# 1) Choose where the two lines should intersect (a mid-range temperature works well)
pivot_temp <- median(kiosk_beach$temperature)
# 2) Control how much smaller the Mall slope is (bigger = more separation at high temps)
beta <- 0.6
# 3) Create 25 new "Mall" rows: same day + same temperature, new customers
kiosk_mall <- kiosk_beach %>%
transmute(
day = day,
kiosk = "Mall",
temperature = temperature,
customers = round(
customers - beta * (temperature - pivot_temp) + rnorm(n(), mean = 0, sd = 3)
#            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
# Adds customers when temperature < pivot, subtracts when temperature > pivot
# -> lines intersect near pivot and Mall has a smaller slope
)
) %>%
mutate(customers = pmax(customers, 0))  # guard against any negative (unlikely)
# 4) Bind Beach + Mall into one dataset (50 rows)
kiosk_beach_mall <- bind_rows(kiosk_beach, kiosk_mall)
# Optional quick check: slopes + intersection behavior
kiosk_beach_mall %>%
group_by(kiosk) %>%
summarise(slope = coef(lm(customers ~ temperature))[2], .groups = "drop")
kiosk_beach_mall |>
point_plot(customers ~ temperature + kiosk,
annot = "model", interval = "none")
kiosk_beach_mall |>
point_plot(customers ~ temperature + kiosk,
annot = "model")
kiosk_beach |>
point_plot(customers ~ temperature, annot = "model")
library(dplyr)
kiosk_beach <- read_csv("kiosk_beach.csv")
set.seed(42)  # so you get the same “Mall” numbers each time
# 1) Choose where the two lines should intersect (a mid-range temperature works well)
pivot_temp <- median(kiosk_beach$temperature)
# 2) Control how much smaller the Mall slope is (bigger = more separation at high temps)
beta <- 1.2
# 3) Create 25 new "Mall" rows: same day + same temperature, new customers
kiosk_mall <- kiosk_beach %>%
transmute(
day = day,
kiosk = "Mall",
temperature = temperature,
customers = round(
customers - beta * (temperature - pivot_temp) + rnorm(n(), mean = 0, sd = 3)
#            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
# Adds customers when temperature < pivot, subtracts when temperature > pivot
# -> lines intersect near pivot and Mall has a smaller slope
)
) %>%
mutate(customers = pmax(customers, 0))  # guard against any negative (unlikely)
# 4) Bind Beach + Mall into one dataset (50 rows)
kiosk_beach_mall <- bind_rows(kiosk_beach, kiosk_mall)
# Optional quick check: slopes + intersection behavior
kiosk_beach_mall %>%
group_by(kiosk) %>%
summarise(slope = coef(lm(customers ~ temperature))[2], .groups = "drop")
kiosk_beach_mall |>
point_plot(customers ~ temperature + kiosk,
annot = "model", interval = "none")
library(dplyr)
kiosk_beach <- read_csv("kiosk_beach.csv")
set.seed(42)  # so you get the same “Mall” numbers each time
# 1) Choose where the two lines should intersect (a mid-range temperature works well)
pivot_temp <- median(kiosk_beach$temperature)
# 2) Control how much smaller the Mall slope is (bigger = more separation at high temps)
beta <- 1.1
# 3) Create 25 new "Mall" rows: same day + same temperature, new customers
kiosk_mall <- kiosk_beach %>%
transmute(
day = day,
kiosk = "Mall",
temperature = temperature,
customers = round(
customers - beta * (temperature - pivot_temp) + rnorm(n(), mean = 0, sd = 3)
#            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
# Adds customers when temperature < pivot, subtracts when temperature > pivot
# -> lines intersect near pivot and Mall has a smaller slope
)
) %>%
mutate(customers = pmax(customers, 0))  # guard against any negative (unlikely)
# 4) Bind Beach + Mall into one dataset (50 rows)
kiosk_beach_mall <- bind_rows(kiosk_beach, kiosk_mall)
# Optional quick check: slopes + intersection behavior
kiosk_beach_mall %>%
group_by(kiosk) %>%
summarise(slope = coef(lm(customers ~ temperature))[2], .groups = "drop")
kiosk_beach_mall |>
point_plot(customers ~ temperature + kiosk,
annot = "model", interval = "none")
kiosk_beach_mall |>
point_plot(customers ~ temperature + kiosk,
annot = "model")
kiosk_beach_mall |>
point_plot(customers ~ temperature + kiosk,
annot = "model", interval = "none")
kiosk_beach <- read_csv("kiosk_beach.csv")
set.seed(42)  # so you get the same “Mall” numbers each time
# 1) Choose where the two lines should intersect (a mid-range temperature works well)
pivot_temp <- median(kiosk_beach$temperature)
# 2) Control how much smaller the Mall slope is (bigger = more separation at high temps)
beta <- 1
# 3) Create 25 new "Mall" rows: same day + same temperature, new customers
kiosk_mall <- kiosk_beach %>%
transmute(
day = day,
kiosk = "Mall",
temperature = temperature,
customers = round(
customers - beta * (temperature - pivot_temp) + rnorm(n(), mean = 0, sd = 3)
#            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
# Adds customers when temperature < pivot, subtracts when temperature > pivot
# -> lines intersect near pivot and Mall has a smaller slope
)
) %>%
mutate(customers = pmax(customers, 0))  # guard against any negative (unlikely)
# 4) Bind Beach + Mall into one dataset (50 rows)
kiosk_beach_mall <- bind_rows(kiosk_beach, kiosk_mall)
# Optional quick check: slopes + intersection behavior
kiosk_beach_mall %>%
group_by(kiosk) %>%
summarise(slope = coef(lm(customers ~ temperature))[2], .groups = "drop")
kiosk_beach_mall |>
point_plot(customers ~ temperature + kiosk,
annot = "model", interval = "none")
kiosk_beach_mall |>
point_plot(customers ~ temperature + kiosk,
annot = "model")
kiosk_beach |>
point_plot(customers ~ temperature, annot = "model")
kiosk_beach_mall |>
point_plot(customers ~ temperature + kiosk,
annot = "model", interval = "none")
kiosk_beach_mall |>
filter(kiosk == "Mall") |>
point_plot(customers ~ temperature ,
annot = "model")
kiosk_beach <- read_csv("kiosk_beach.csv")
set.seed(42)  # so you get the same “Mall” numbers each time
# 1) Choose where the two lines should intersect (a mid-range temperature works well)
pivot_temp <- median(kiosk_beach$temperature)
# 2) Control how much smaller the Mall slope is (bigger = more separation at high temps)
beta <- 0.9
# 3) Create 25 new "Mall" rows: same day + same temperature, new customers
kiosk_mall <- kiosk_beach %>%
transmute(
day = day,
kiosk = "Mall",
temperature = temperature,
customers = round(
customers - beta * (temperature - pivot_temp) + rnorm(n(), mean = 0, sd = 3)
#            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
# Adds customers when temperature < pivot, subtracts when temperature > pivot
# -> lines intersect near pivot and Mall has a smaller slope
)
) %>%
mutate(customers = pmax(customers, 0))  # guard against any negative (unlikely)
# 4) Bind Beach + Mall into one dataset (50 rows)
kiosk_beach_mall <- bind_rows(kiosk_beach, kiosk_mall)
# Optional quick check: slopes + intersection behavior
kiosk_beach_mall %>%
group_by(kiosk) %>%
summarise(slope = coef(lm(customers ~ temperature))[2], .groups = "drop")
kiosk_beach_mall |>
point_plot(customers ~ temperature + kiosk,
annot = "model", interval = "none")
kiosk_beach_mall |>
point_plot(customers ~ temperature + kiosk,
annot = "model")
kiosk_beach_mall |>
filter(kiosk == "Mall") |>
point_plot(customers ~ temperature ,
annot = "model")
kiosk_beach |>
point_plot(customers ~ temperature, annot = "model")
kiosk_beach_mall |>
filter(kiosk == "Mall") |>
point_plot(customers ~ temperature ,
annot = "model")
library(dplyr)
set.seed(42)
kiosk_beach <- read_csv("kiosk_beach.csv")
set.seed(42)
# 1. Fit the Beach regression (DO NOT CHANGE THE DATA)
beach_fit <- lm(customers ~ temperature, data = kiosk_beach)
b0 <- coef(beach_fit)[1]
b1 <- coef(beach_fit)[2]   # observed Beach slope
# 2. Choose where lines intersect (mid-range is safest)
pivot_temp <- median(kiosk_beach$temperature)
pivot_customers <- b0 + b1 * pivot_temp
# 3. Choose a smaller Mall slope (fraction of Beach slope)
mall_slope <- 0.55 * b1    # smaller but still clearly positive
# 4. Choose Mall noise (tight!)
sd_mall <- 2
# 5. Generate Mall customers
kiosk_mall <- kiosk_beach %>%
transmute(
day = day,
kiosk = "Mall",
temperature = temperature,
customers = round(
pivot_customers +
mall_slope * (temperature - pivot_temp) +
rnorm(n(), 0, sd_mall)
)
)
# 6. Combine
kiosk_beach_mall <- bind_rows(kiosk_beach, kiosk_mall)
# --- Optional checks ---
summary(lm(customers ~ temperature,
data = filter(kiosk_beach_mall, kiosk == "Beach")))
summary(lm(customers ~ temperature,
data = filter(kiosk_beach_mall, kiosk == "Mall")))
kiosk_mall |>
point_plot(customers ~ temperature, annot = "model")
kiosk_beach |>
point_plot(customers ~ temperature, annot = "model")
kiosk_beach_mall |>
point_plot(customers ~ temperature + kiosk,
annot = "model",
interval = "none")
kiosk_beach <- read_csv("kiosk_beach.csv")
set.seed(42)
# 1. Fit the Beach regression (DO NOT CHANGE THE DATA)
beach_fit <- lm(customers ~ temperature, data = kiosk_beach)
b0 <- coef(beach_fit)[1]
b1 <- coef(beach_fit)[2]   # observed Beach slope
# 2. Choose where lines intersect (mid-range is safest)
pivot_temp <- median(kiosk_beach$temperature)
pivot_customers <- b0 + b1 * pivot_temp
# 3. Choose a smaller Mall slope (fraction of Beach slope)
mall_slope <- 0.50 * b1    # smaller but still clearly positive
# 4. Choose Mall noise (tight!)
sd_mall <- 2
# 5. Generate Mall customers
kiosk_mall <- kiosk_beach %>%
transmute(
day = day,
kiosk = "Mall",
temperature = temperature,
customers = round(
pivot_customers +
mall_slope * (temperature - pivot_temp) +
rnorm(n(), 0, sd_mall)
)
)
# 6. Combine
kiosk_beach_mall <- bind_rows(kiosk_beach, kiosk_mall)
# --- Optional checks ---
summary(lm(customers ~ temperature,
data = filter(kiosk_beach_mall, kiosk == "Beach")))
summary(lm(customers ~ temperature,
data = filter(kiosk_beach_mall, kiosk == "Mall")))
kiosk_mall |>
point_plot(customers ~ temperature, annot = "model")
kiosk_beach |>
point_plot(customers ~ temperature, annot = "model")
kiosk_beach_mall |>
point_plot(customers ~ temperature + kiosk,
annot = "model",
interval = "none")
kiosk_beach <- read_csv("kiosk_beach.csv")
set.seed(42)
# 1. Fit the Beach regression (DO NOT CHANGE THE DATA)
beach_fit <- lm(customers ~ temperature, data = kiosk_beach)
b0 <- coef(beach_fit)[1]
b1 <- coef(beach_fit)[2]   # observed Beach slope
# 2. Choose where lines intersect (mid-range is safest)
pivot_temp <- median(kiosk_beach$temperature)
pivot_customers <- b0 + b1 * pivot_temp
# 3. Choose a smaller Mall slope (fraction of Beach slope)
mall_slope <- 0.45 * b1    # smaller but still clearly positive
# 4. Choose Mall noise (tight!)
sd_mall <- 2
# 5. Generate Mall customers
kiosk_mall <- kiosk_beach %>%
transmute(
day = day,
kiosk = "Mall",
temperature = temperature,
customers = round(
pivot_customers +
mall_slope * (temperature - pivot_temp) +
rnorm(n(), 0, sd_mall)
)
)
# 6. Combine
kiosk_beach_mall <- bind_rows(kiosk_beach, kiosk_mall)
# --- Optional checks ---
summary(lm(customers ~ temperature,
data = filter(kiosk_beach_mall, kiosk == "Beach")))
summary(lm(customers ~ temperature,
data = filter(kiosk_beach_mall, kiosk == "Mall")))
kiosk_mall |>
point_plot(customers ~ temperature, annot = "model")
kiosk_beach |>
point_plot(customers ~ temperature, annot = "model")
kiosk_beach_mall |>
point_plot(customers ~ temperature + kiosk,
annot = "model",
interval = "none")
kiosk_mall |>
point_plot(customers ~ temperature, annot = "model")
kiosk_beach |>
point_plot(customers ~ temperature, annot = "model")
kiosk_beach_mall |>
point_plot(customers ~ temperature + kiosk,
annot = "model",
interval = "none")
pwd
getwd()
write_csv(kiosk_beach_mall, "kiosk_beack_mall.csv")
library(dplyr)
kiosk_beach <- read_csv("kiosk_beach.csv")
set.seed(42)
# 1. Fit the Beach regression (DO NOT CHANGE THE DATA)
beach_fit <- lm(customers ~ temperature, data = kiosk_beach)
b0 <- coef(beach_fit)[1]
b1 <- coef(beach_fit)[2]   # observed Beach slope
# 2. Choose where lines intersect (mid-range is safest)
pivot_temp <- median(kiosk_beach$temperature)
pivot_customers <- b0 + b1 * pivot_temp
# 3. Choose a smaller Mall slope (fraction of Beach slope)
mall_slope <- 0.45 * b1    # smaller but still clearly positive
# 4. Choose Mall noise (tight!)
sd_mall <- 2
# 5. Generate Mall customers
kiosk_mall <- kiosk_beach %>%
transmute(
day = day,
kiosk = "Mall",
temperature = temperature,
customers = round(
pivot_customers +
mall_slope * (temperature - pivot_temp) +
rnorm(n(), 0, sd_mall)
)
)
# 6. Combine
kiosk_beach_mall_temp <- bind_rows(kiosk_beach, kiosk_mall)
# --- Optional checks ---
summary(lm(customers ~ temperature,
data = filter(kiosk_beach_mall, kiosk == "Beach")))
summary(lm(customers ~ temperature,
data = filter(kiosk_beach_mall, kiosk == "Mall")))
kiosk_mall |>
point_plot(customers ~ temperature, annot = "model")
kiosk_beach |>
point_plot(customers ~ temperature, annot = "model")
kiosk_beach_mall_temp |>
point_plot(customers ~ temperature + kiosk,
annot = "model",
interval = "none")
View(kiosk_beach_mall_temp)
kiosk_beach_mall_temp |>
point_plot(customers ~ temperature + kiosk,
annot = "model",
interval = "none")
kiosk_beach_mall_temp |>
point_plot(customers ~ temperature + kiosk,
annot = "model",
interval = "none")
kiosk_beach |>
point_plot(customers ~ temperature, annot = "model")
kiosk_beach_mall_temp |>
point_plot(customers ~ temperature + kiosk,
annot = "model",
interval = "none")
kiosk_beach_mall_temp |>
model_train(customers ~ temperature + kiosk) |>
coef()
library(readr)
kiosk_mall_beach <- read_csv("kiosk_mall_beach.csv")
View(kiosk_mall_beach)
kiosk_mall_beach |>
summarize(mean(customers), .by = kiosk)
kiosk_mall_beach |>
summarize(mean(customers), max(cutomers), min(customers) .by = kiosk)
kiosk_mall_beach |>
summarize(mean(customers), max(cutomers), min(customers) .by = kiosk)
kiosk_mall_beach |>
summarize(mean(customers), max(cutomers), min(customers), .by = kiosk)
kiosk_mall_beach |>
summarize(mean(customers), max(customers), min(customers), .by = kiosk)
library(readr)
kiosk_beack_mall_temp <- read_csv("kiosk_beack_mall_temp.csv")
View(kiosk_beack_mall_temp)
47.17 + 1.055771*70 -0.04
47.17 + 1.055771*70
library(readr)
kiosk_beack_mall_temp <- read_csv("kiosk_beack_mall_temp.csv")
View(kiosk_beack_mall_temp)
k <- kiosk_beach_mall_temp |>
mutate(customers = 10*customers,
temperature = temperature - 70)
k |>
model_train(customers ~ temperature + kiosk) |>
coef()
View(k)
kiosk_beach_mall_temp |>
ggplot(aes(temperature, customers, color = kiosk)) +
geom_smooth(method = lm, se = FALSE)
kiosk_beach_mall_temp |>
point_plot(customers ~ temperature + kiosk, annot = "model")
mpg |>
point_plot(cty ~ displ + drv, annot = "model")
kiosk_beach_mall_temp |>
ggplot(aes(temperature, customers, color = kiosk)) +
geom_smooth(method = lm, se = FALSE)
kiosk_beach_mall_temp |>
point_plot(customers ~ temperature + kiosk,
annot = "model",
interval = "none")
kiosk_beach_mall_temp |>
point_plot(customers ~ temperature + kiosk,
annot = "model",
interval = "none")
kiosk_beach_mall_temp |>
filter(kiosk == "Mall") |>
model_train(customers ~ temperature) |>
coef()
kiosk_beach_mall_temp |>
filter(kiosk == "Beach") |>
model_train(customers ~ temperature) |>
coef()
kiosk_beach_mall_temp |>
filter(kiosk == "Beach") |>
model_train(customers ~ temperature) |>
coef()
kiosk_beach_mall_temp |>
model_train(customers ~ temperature*kiosk) |>
coef()
kiosk_beach_mall_temp |>
model_train(customers ~ temperature*kiosk) |>
coef()
kiosk_beach_mall_temp |>
model_train(customers ~ temperature*kiosk) |>
coef()
